!function(t){var e,a;!function(){function t(t,e){if(!e)return t;if(0===t.indexOf(".")){var a=e.split("/"),n=t.split("/"),r=a.length-1,i=n.length,o=0,s=0;t:for(var u=0;i>u;u++)switch(n[u]){case"..":if(!(r>o))break t;o++,s++;break;case".":s++;break;default:break t}return a.length=r-o,n=n.slice(s),a.concat(n).join("/")}return t}function n(e){function a(a,o){if("string"==typeof a){var s=n[a];return s||(s=i(t(a,e)),n[a]=s),s}a instanceof Array&&(o=o||function(){},o.apply(this,r(a,o,e)))}var n={};return a}function r(a,n,r){for(var s=[],u=o[r],c=0,h=Math.min(a.length,n.length);h>c;c++){var p,d=t(a[c],r);switch(d){case"require":p=u&&u.require||e;break;case"exports":p=u.exports;break;case"module":p=u;break;default:p=i(d)}s.push(p)}return s}function i(t){var e=o[t];if(!e)throw new Error("No "+t);if(!e.defined){var a=e.factory,n=a.apply(this,r(e.deps||[],a,t));"undefined"!=typeof n&&(e.exports=n),e.defined=1}return e.exports}var o={};a=function(t,e,a){o[t]={id:t,deps:e,factory:a,defined:0,exports:{},require:n(t)}},e=n("")}(),a("ig",["ig/ig"],function(t){return t}),a("ig/ig",["require"],function(){window.requestAnimationFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame||window.oRequestAnimationFrame||function(t){var e,a,n=this;setTimeout(function(){e=+new Date,t(e),a=+new Date,n.timeout=1e3/60-(a-e)},n.timeout)}}(),window.cancelAnimationFrame=function(){return window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.webkitCancelRequestAnimationFrame||window.mozCancelAnimationFrame||window.mozCancelRequestAnimationFrame||window.msCancelAnimationFrame||window.msCancelRequestAnimationFrame||window.oCancelAnimationFrame||window.oCancelRequestAnimationFrame||window.clearTimeout}();var t={};return t}),a("ig/util",["require"],function(){var t=Math.PI/180,e=180/Math.PI,a=Object.prototype,n={};return n.noop=function(){},n.getType=function(t){var e=a.toString.call(t).slice(8,-1);return e.toLowerCase()},n.isType=function(t,e){var a=n.getType(e);return t.toLowerCase()===a},n.isWindow=function(t){return null!=t&&t===t.window},n.isPlainObject=function(t){return"object"!==n.getType(t)||t.nodeType||n.isWindow(t)?!1:t.constructor&&!{}.hasOwnProperty.call(t.constructor.prototype,"isPrototypeOf")?!1:!0},n.extend=function(){var t,e,a,r,i,o,s=arguments[0]||{},u=1,c=arguments.length,h=!1;for("boolean"==typeof s&&(h=s,s=arguments[u]||{},u++),"object"==typeof s||n.isType("function",s)||(s={}),u===c&&(s=this,u--);c>u;u++)if(null!=(t=arguments[u]))for(e in t)if(t.hasOwnProperty(e)){if(a=s[e],r=t[e],s===r)continue;h&&r&&(n.isPlainObject(r)||(i=Array.isArray(r)))?(i?(i=!1,o=a&&Array.isArray(a)?a:[]):o=a&&n.isPlainObject(a)?a:{},s[e]=n.extend(h,o,r)):void 0!==r&&(s[e]=r)}return s},n.inherits=function(t,e){var a=function(){};a.prototype=e.prototype;var n=t.prototype,r=t.prototype=new a;for(var i in n)n.hasOwnProperty(i)&&(r[i]=n[i]);return t.prototype.constructor=t,t.superClass=e.prototype,t},n.deg2Rad=function(e){return e*t},n.rad2Deg=function(t){return t*e},n.removeArrByCondition=function(t,e){for(var a,n=-1,r=0,i=t.length;i>r;r++)if(a=t[r],e(a)){n=r;break}-1!==n&&t.splice(n,1)},n.window2Canvas=function(t,e,a){var n=t.getBoundingClientRect();return{x:Math.round(e-n.left*(t.width/n.width)),y:Math.round(a-n.top*(t.height/n.height))}},n.domWrap=function(t,e,a){return t.parentNode.insertBefore(e,t),e.appendChild(t),e.id=a||"ig-create-dom-"+Date.now(),t},n.getElementOffset=function(t){for(var e=t.offsetLeft,a=t.offsetTop;(t=t.offsetParent)&&t!=document.body&&t!=document;)e+=t.offsetLeft,a+=t.offsetTop;return{x:e,y:a}},n}),a("ig/easing",["require"],function(){var t={};return t.linear=function(t,e,a,n){return a*t/n+e},t.easeInQuad=function(t,e,a,n){return a*(t/=n)*t+e},t.easeOutQuad=function(t,e,a,n){return-a*(t/=n)*(t-2)+e},t.easeInOutQuad=function(t,e,a,n){return(t/=n/2)<1?a/2*t*t+e:-a/2*(--t*(t-2)-1)+e},t.easeInCubic=function(t,e,a,n){return a*(t/=n)*t*t+e},t.easeOutCubic=function(t,e,a,n){return a*((t=t/n-1)*t*t+1)+e},t.easeInOutCubic=function(t,e,a,n){return(t/=n/2)<1?a/2*t*t*t+e:a/2*((t-=2)*t*t+2)+e},t.easeInQuart=function(t,e,a,n){return a*(t/=n)*t*t*t+e},t.easeOutQuart=function(t,e,a,n){return-a*((t=t/n-1)*t*t*t-1)+e},t.easeInOutQuart=function(t,e,a,n){return(t/=n/2)<1?a/2*t*t*t*t+e:-a/2*((t-=2)*t*t*t-2)+e},t.easeInQuint=function(t,e,a,n){return a*(t/=n)*t*t*t*t+e},t.easeOutQuint=function(t,e,a,n){return a*((t=t/n-1)*t*t*t*t+1)+e},t.easeInOutQuint=function(t,e,a,n){return(t/=n/2)<1?a/2*t*t*t*t*t+e:a/2*((t-=2)*t*t*t*t+2)+e},t.easeInSine=function(t,e,a,n){return-a*Math.cos(t/n*(Math.PI/2))+a+e},t.easeOutSine=function(t,e,a,n){return a*Math.sin(t/n*(Math.PI/2))+e},t.easeInOutSine=function(t,e,a,n){return-a/2*(Math.cos(Math.PI*t/n)-1)+e},t.easeInExpo=function(t,e,a,n){return 0===t?e:a*Math.pow(2,10*(t/n-1))+e},t.easeOutExpo=function(t,e,a,n){return t===n?e+a:a*(-Math.pow(2,-10*t/n)+1)+e},t.easeInOutExpo=function(t,e,a,n){return 0===t?e:t===n?e+a:(t/=n/2)<1?a/2*Math.pow(2,10*(t-1))+e:a/2*(-Math.pow(2,-10*--t)+2)+e},t.easeInCirc=function(t,e,a,n){return-a*(Math.sqrt(1-(t/=n)*t)-1)+e},t.easeOutCirc=function(t,e,a,n){return a*Math.sqrt(1-(t=t/n-1)*t)+e},t.easeInOutCirc=function(t,e,a,n){return(t/=n/2)<1?-a/2*(Math.sqrt(1-t*t)-1)+e:a/2*(Math.sqrt(1-(t-=2)*t)+1)+e},t.easeInElastic=function(t,e,a,n,r,i){if(0===t)return e;if(1===(t/=n))return e+a;i||(i=.3*n);var o;return!r||r<Math.abs(a)?(r=a,o=i/4):o=i/(2*Math.PI)*Math.asin(a/r),-(r*Math.pow(2,10*(t-=1))*Math.sin(2*(t*n-o)*Math.PI/i))+e},t.easeOutElastic=function(t,e,a,n,r,i){if(0===t)return e;if(1===(t/=n))return e+a;i||(i=.3*n);var o;return!r||r<Math.abs(a)?(r=a,o=i/4):o=i/(2*Math.PI)*Math.asin(a/r),r*Math.pow(2,-10*t)*Math.sin(2*(t*n-o)*Math.PI/i)+a+e},t.easeInOutElastic=function(t,e,a,n,r,i){if(0===t)return e;if(2===(t/=n/2))return e+a;i||(i=.3*n*1.5);var o;return!r||r<Math.abs(a)?(r=a,o=i/4):o=i/(2*Math.PI)*Math.asin(a/r),1>t?-.5*r*Math.pow(2,10*(t-=1))*Math.sin(2*(t*n-o)*Math.PI/i)+e:r*Math.pow(2,-10*(t-=1))*Math.sin(2*(t*n-o)*Math.PI/i)*.5+a+e},t.easeInBack=function(t,e,a,n,r){return void 0===r&&(r=1.70158),a*(t/=n)*t*((r+1)*t-r)+e},t.easeOutBack=function(t,e,a,n,r){return void 0===r&&(r=1.70158),a*((t=t/n-1)*t*((r+1)*t+r)+1)+e},t.easeInOutBack=function(t,e,a,n,r){return void 0===r&&(r=1.70158),(t/=n/2)<1?a/2*t*t*(((r*=1.525)+1)*t-r)+e:a/2*((t-=2)*t*(((r*=1.525)+1)*t+r)+2)+e},t.easeInBounce=function(e,a,n,r){return n-t.easeOutBounce(r-e,0,n,r)+a},t.easeOutBounce=function(t,e,a,n){return(t/=n)<1/2.75?7.5625*a*t*t+e:2/2.75>t?a*(7.5625*(t-=1.5/2.75)*t+.75)+e:2.5/2.75>t?a*(7.5625*(t-=2.25/2.75)*t+.9375)+e:a*(7.5625*(t-=2.625/2.75)*t+.984375)+e},t.easeInOutBounce=function(e,a,n,r){return r/2>e?.5*t.easeInBounce(2*e,0,n,r)+a:.5*t.easeOutBounce(2*e-r,0,n,r)+.5*n+a},t}),a("ig/env",["require"],function(){function t(t){var e={},a={},n=t.match(/Web[kK]it[\/]{0,1}([\d.]+)/),r=t.match(/(Android);?[\s\/]+([\d.]+)?/),i=!!t.match(/\(Macintosh\; Intel /),o=t.match(/(iPad).*OS\s([\d_]+)/),s=t.match(/(iPod)(.*OS\s([\d_]+))?/),u=!o&&t.match(/(iPhone\sOS)\s([\d_]+)/),c=t.match(/(webOS|hpwOS)[\s\/]([\d.]+)/),h=t.match(/Windows Phone ([\d.]+)/),p=c&&t.match(/TouchPad/),d=t.match(/Kindle\/([\d.]+)/),l=t.match(/Silk\/([\d._]+)/),f=t.match(/(BlackBerry).*Version\/([\d.]+)/),m=t.match(/(BB10).*Version\/([\d.]+)/),g=t.match(/(RIM\sTablet\sOS)\s([\d.]+)/),v=t.match(/PlayBook/),w=t.match(/Chrome\/([\d.]+)/)||t.match(/CriOS\/([\d.]+)/),y=t.match(/Firefox\/([\d.]+)/),S=t.match(/MSIE\s([\d.]+)/)||t.match(/Trident\/[\d](?=[^\?]+).*rv:([0-9.].)/),b=!w&&t.match(/(iPhone|iPod|iPad).*AppleWebKit(?!.*Safari)/),x=b||t.match(/Version\/([\d.]+)([^S](Safari)|[^M]*(Mobile)[^S]*(Safari))/),F=t.match(/MicroMessenger\/([\d.]+)/),C=t.match(/baiduboxapp\/[^\/]+\/([\d.]+)_/)||t.match(/baiduboxapp\/([\d.]+)/)||t.match(/BaiduHD\/([\d.]+)/)||t.match(/FlyFlow\/([\d.]+)/)||t.match(/baidubrowser\/([\d.]+)/),I=t.match(/MQQBrowser\/([\d.]+)/)||t.match(/QQ\/([\d.]+)/),O=t.match(/UCBrowser\/([\d.]+)/),M=t.match(/SogouMobileBrowser\/([\d.]+)/),T=r&&t.match(/MiuiBrowser\/([\d.]+)/),P=t.match(/LBKIT/),E=t.match(/Mercury\/([\d.]+)/);return(a.webkit=!!n)&&(a.version=n[1]),r&&(e.android=!0,e.version=r[2]),u&&!s&&(e.ios=e.iphone=!0,e.version=u[2].replace(/_/g,".")),o&&(e.ios=e.ipad=!0,e.version=o[2].replace(/_/g,".")),s&&(e.ios=e.ipod=!0,e.version=s[3]?s[3].replace(/_/g,"."):null),h&&(e.wp=!0,e.version=h[1]),c&&(e.webos=!0,e.version=c[2]),p&&(e.touchpad=!0),f&&(e.blackberry=!0,e.version=f[2]),m&&(e.bb10=!0,e.version=m[2]),g&&(e.rimtabletos=!0,e.version=g[2]),v&&(a.playbook=!0),d&&(e.kindle=!0,e.version=d[1]),l&&(a.silk=!0,a.version=l[1]),!l&&e.android&&t.match(/Kindle Fire/)&&(a.silk=!0),w&&(a.chrome=!0,a.version=w[1]),y&&(a.firefox=!0,a.version=y[1]),S&&(a.ie=!0,a.version=S[1]),x&&(i||e.ios)&&(a.safari=!0,i&&(a.version=x[1])),b&&(a.webview=!0),F&&(a.wechat=!0,a.version=F[1]),C&&(delete a.webview,a.baidu=!0,a.version=C[1]),I&&(a.qq=!0,a.version=I[1]),O&&(delete a.webview,a.uc=!0,a.version=O[1]),M&&(delete a.webview,a.sogou=!0,a.version=M[1]),T&&(a.xiaomi=!0,a.version=T[1]),P&&(a.liebao=!0,a.version="0"),E&&(a.mercury=!0,a.version=E[1]),navigator.standalone&&(a.standalone=!0),e.tablet=!!(o||v||r&&!t.match(/Mobile/)||y&&t.match(/Tablet/)||S&&!t.match(/Phone/)&&t.match(/Touch/)),e.phone=!(e.tablet||e.ipod||!(r||u||c||f||m||w&&t.match(/Android/)||w&&t.match(/CriOS\/([\d.]+)/)||y&&t.match(/Mobile/)||S&&t.match(/Touch/))),{browser:a,os:e}}function e(t){t.audioData=!!window.Audio,t.webAudio=!(!window.AudioContext&&!window.webkitAudioContext);var e=document.createElement("audio"),a=!1;try{(a=!!e.canPlayType)&&(e.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,"")&&(t.ogg=!0),(e.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,"")||e.canPlayType("audio/opus;").replace(/^no$/,""))&&(t.opus=!0),e.canPlayType("audio/mpeg;").replace(/^no$/,"")&&(t.mp3=!0),e.canPlayType('audio/wav; codecs="1"').replace(/^no$/,"")&&(t.wav=!0),(e.canPlayType("audio/x-m4a;")||e.canPlayType("audio/aac;").replace(/^no$/,""))&&(t.m4a=!0),e.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")&&(t.webm=!0))}catch(n){}}var a=t(navigator.userAgent),n={browser:a.browser,os:a.os,supportOrientation:"number"==typeof window.orientation&&"object"==typeof window.onorientationchange,supportTouch:"ontouchstart"in window||window.DocumentTouch&&document instanceof window.DocumentTouch,supportGeolocation:null!=navigator.geolocation,isAndroid:a.os.android,isIOS:a.os.ios,isPhone:a.os.phone,isTablet:a.os.tablet,isMobile:a.os.phone||a.os.tablet};return e(n),n}),a("ig/Animation",["require","./util","./Event","./easing"],function(t){function e(t){return t=t||{},this.p={},a.extend(!0,this.p,{name:o++,source:{},target:null,range:null,tween:r.linear,repeat:!1,duration:1e3,fps:i},t),this.setup(),n.apply(this,this.p),this}var a=t("./util"),n=t("./Event"),r=t("./easing"),i=60,o=0;return e.prototype={constructor:e,setup:function(){var t=this.p;t.paused=!1,t.repeatCount=0,t.then=Date.now(),t.interval=1e3/t.fps,t.curFrame=0,t.curState={},t.initState={},t.frames=Math.ceil(t.duration*t.fps/1e3);var e=t.source,n=t.target,r=t.range;if(r){for(var i in r)t.curState[i]={from:parseFloat(parseFloat(e[i])-parseFloat(r[i])),cur:parseFloat(e[i]),to:parseFloat(parseFloat(e[i])+parseFloat(r[i]))};return this}if("array"!==a.getType(n)){for(var i in n)t.initState[i]=t.curState[i]={from:parseFloat(e[i]),cur:parseFloat(e[i]),to:parseFloat(n[i])};return this}t.animIndex=0,t.animLength=n.length;for(var o=0;o<t.animLength;o++)for(var i in n[o])0===o&&(t.curState[i]={from:parseFloat(e[i]),cur:parseFloat(e[i]),to:parseFloat(n[o][i])}),t.initState[i]={from:parseFloat(e[i]),cur:parseFloat(e[i]),to:parseFloat(n[o][i])};return this},play:function(){var t=this.p;return t.requestID&&this.stop(),t.paused=!1,this.step(),this},stop:function(){return window.cancelAnimationFrame(this.p.requestID),this},destroy:function(){this.stop(),this.clearEvents()},togglePause:function(){return this.p.paused=!this.p.paused,this},pause:function(){return this.p.paused=!0,this},resume:function(){return this.p.paused=!1,this},next:function(){this.stop();var t=this.p;return t.curFrame++,t.curFrame=t.curFrame>t.frames?t.frames:t.curFrame,this.step.call(this),this},prev:function(){this.stop();var t=this.p;return t.curFrame--,t.curFrame=t.curFrame<0?0:t.curFrame,this.step.call(this),this},gotoAndPlay:function(t){return this.stop(),this.p.curFrame=t,this.play.call(this),this},gotoAndStop:function(t){return this.stop(),this.p.curFrame=t,this.step.call(this),this},swapFromTo:function(){var t=this.p;if(t.curFrame=0,t.curState={},"array"===a.getType(t.target)){t.target.reverse(),t.animIndex=0,t.animLength=t.target.length;for(var e in t.target[t.animIndex])t.curState[e]=t.repeatCount%2===0?{from:t.initState[e].from,cur:t.initState[e].cur,to:t.initState[e].to}:{from:t.initState[e].to,cur:t.initState[e].to,to:t.initState[e].from}}else for(var e in t.target)t.curState[e]=t.repeatCount%2===0?{from:t.initState[e].from,cur:t.initState[e].cur,to:t.initState[e].to}:{from:t.initState[e].to,cur:t.initState[e].to,to:t.initState[e].from};return this},step:function(){var t=this,e=t.p;if(e.requestID=window.requestAnimationFrame(function(){return function(){t.step.call(t)}}(t)),!(e.paused||(e.now=Date.now(),e.delta=e.now-e.then,e.delta<=e.interval))){t.fire("step",{data:{source:e.source,instance:t}}),e.then=e.now-e.delta%e.interval;var a;for(var n in e.curState)a=e.tween(e.curFrame,e.curState[n].cur,e.curState[n].to-e.curState[n].cur,e.frames).toFixed(2),e.source[n]=parseFloat(a);if(e.curFrame++,!(e.curFrame<e.frames))if(e.range&&!e.rangeExec){e.curFrame=0;for(var n in e.curState)e.curState[n]={from:e.curState[n].to,cur:e.curState[n].to,to:e.curState[n].from};e.repeat?(e.repeatCount++,e.repeatCount%2===0&&t.fire("repeat",{data:{source:e.source,instance:t,repeatCount:e.repeatCount/2}})):e.rangeExec=!0}else if(e.animLength)if(t.fire("groupComplete",{data:{source:e.source,instance:t}}),e.animIndex<e.animLength-1){e.animIndex++,e.curFrame=0,e.curState={};var r=e.repeatCount%2===0;for(var n in e.target[e.animIndex])e.curState[n]={from:r?e.initState[n].from:e.initState[n].to,cur:r?e.initState[n].cur:e.initState[n].to,to:r?e.initState[n].to:e.initState[n].from}}else e.repeat?(e.repeatCount++,t.swapFromTo(),t.fire("repeat",{data:{source:e.source,instance:t,repeatCount:e.repeatCount}})):(t.stop(),e.paused=!1,t.fire("complete",{data:{source:e.source,instance:t}}));else e.repeat?(e.repeatCount++,t.swapFromTo(),t.fire("repeat",{data:{source:e.source,instance:t,repeatCount:e.repeatCount}})):(t.stop(),e.paused=!1,t.fire("complete",{data:{source:e.source,instance:t}}))}}},a.inherits(e,n),e}),a("ig/Vector",["require"],function(){function t(t,e){this.x=t||0,this.y=e||t||0}var e=Math.sqrt,a=Math.pow;return t.prototype={constructor:t,normalize:function(){var t=this.getMagnitude();return 0!==t&&(this.x/=t,this.y/=t),this},getMagnitude:function(){return e(a(this.x,2)+a(this.y,2))},add:function(e,a){var n=this.x+e.x,r=this.y+e.y;return a?new t(n,r):(this.x=n,this.y=r,this)},sub:function(e,a){var n=this.x-e.x,r=this.y-e.y;return a?new t(n,r):(this.x=n,this.y=r,this)},dot:function(t){return this.x*t.x+this.y*t.y},edge:function(t){return this.sub(t,!0)},perpendicular:function(e){var a=-this.x,n=this.y;return e?new t(a,n):(this.x=a,this.y=n,this)},normal:function(){return this.perpendicular(!0).normalize()}},t}),a("ig/Game",["require","./Event","./util","./env","./Stage","./resourceLoader"],function(t){function e(t){if(this.p={},o.extend(!0,this.p,{name:"ig_game_"+p++,fps:h,canvas:null,maximize:!1,scaleFit:!0,width:d,height:f,maxWidth:l,maxHeight:m,horizontalPageScroll:null},t),!this.p.canvas)throw new Error("Game initialize must be require a canvas param");return this.p.paused=!1,this.p.stageStack=[],this.p.stages={},a.call(this),this._={},this.resources=this.p.resources=c.resources,i.apply(this,this.p),this}function a(){var t=this.p;t.canvas=o.domWrap(t.canvas,document.createElement("div"),"ig-game-container-"+t.name),t.canvas.width=t.width,t.canvas.height=t.height;var e=parseInt(t.canvas.width,10),a=parseInt(t.canvas.height,10),i=t.maxWidth||5e3,u=t.maxHeight||5e3;if(t.maximize){document.body.style.padding=0,document.body.style.margin=0;var c,h=o.getType(t.horizontalPageScroll);c="number"===h?t.horizontalPageScroll:"boolean"===h?17:0,e=Math.min(window.innerWidth,i)-c,a=Math.min(window.innerHeight-5,u)}s.supportTouch&&(t.canvas.style.height=2*a+"px",window.scrollTo(0,1),e=Math.min(window.innerWidth,i),a=Math.min(window.innerHeight,u)),t.ctx=t.canvas.getContext("2d"),t.canvas.style.height=a+"px",t.canvas.style.width=e+"px",t.canvas.width=e,t.canvas.height=a,t.canvas.style.position="relative",t.width=t.canvas.width,t.cssWidth=t.canvas.style.width,t.height=t.canvas.height,t.cssHeight=t.canvas.style.height,n.call(this);var p=t.canvas.parentNode;p.style.width=e+"px",p.style.margin="0 auto",p.style.position="relative",t.scaleFit&&r.call(this);var l=this;return window.addEventListener(s.supportOrientation?"orientationchange":"resize",function(){setTimeout(function(){window.scrollTo(0,1),t.scaleFit&&r.call(l)},0)},!1),t.ratioX=t.width/d,t.ratioY=t.height/f,this}function n(){var t=this.p;t.offCanvas||(t.offCanvas=document.createElement("canvas"),t.offCtx=t.offCanvas.getContext("2d")),t.offCanvas.width=t.canvas.width,t.offCanvas.style.width=t.canvas.style.width,t.offCanvas.height=t.canvas.height,t.offCanvas.style.height=t.canvas.style.height}function r(){var t=this.p,e=window.innerWidth,a=window.innerHeight,r=e/a,i=t.canvas.width/t.canvas.height,o=r>i?a/t.canvas.height:e/t.canvas.width,s=t.canvas.width*o,u=t.canvas.height*o;if(t.canvas.style.width=s+"px",t.canvas.style.height=u+"px",t.canvas.parentNode&&(t.canvas.parentNode.style.width=s+"px",t.canvas.parentNode.style.height=u+"px"),i>=r){var c=(a-u)/2;t.canvas.style.top=c+"px"}t.width=t.canvas.width,t.cssWidth=t.canvas.style.width,t.height=t.canvas.height,t.cssHeight=t.canvas.style.height,t.scaleRatio=o,n.call(this)}var i=t("./Event"),o=t("./util"),s=t("./env"),u=t("./Stage"),c=t("./resourceLoader"),h=60,p=0,d=320,l=5e3,f=480,m=5e3;return e.prototype={constructor:e,start:function(){var t=this._,e=this.p;e.paused=!1,t.startTime=Date.now(),t.now=0,t.interval=1e3/e.fps,t.delta=0,t.realFpsStart=Date.now(),t.realFps=0,t.realDelta=0,t.totalFrameCounter=0;var a="",n=o.noop,r=arguments.length;switch(r){case 1:"function"===o.getType(arguments[0])?n=arguments[0]:(a=arguments[0],n=o.noop);break;case 2:a=arguments[0],n=arguments[1]}if(a){for(var i=e.stageStack,s=-1,u=0,c=i.length;c>u;u++)if(i[u].name===a){s=u;break}this.swapStage(s,0)}this.stop();var h=this;return h.render.call(h,a),"function"===o.getType(n)&&n.call(h,{data:{startTime:t.startTime,interval:t.interval}}),this},render:function(){var t=this,e=t.p,a=t._;if(e.requestID=window.requestAnimationFrame(function(t){return function(){t.render.call(t)}}(t)),!e.paused){if(a.now=Date.now(),a.delta=a.now-a.startTime,a.delta>a.interval){a.totalFrameCounter++,a.startTime=a.now-a.delta%a.interval,t.fire("beforeGameRender",{data:{startTime:a.startTime,totalFrameCounter:a.totalFrameCounter}});var n=t.getCurrentStage();n&&(n.update(a.totalFrameCounter,a.delta),n.render()),t.fire("afterGameRender",{data:{startTime:a.startTime,totalFrameCounter:a.totalFrameCounter}})}a.realDelta>1e3?(a.realFpsStart=Date.now(),a.realDelta=0,t.fire("gameFPS",{data:{fps:a.realFps,totalFrameCounter:a.totalFrameCounter}}),a.realFps=0):(a.realDelta=Date.now()-a.realFpsStart,++a.realFps)}},pause:function(){return this.p.paused=!0,this},resume:function(){return this.p.paused=!1,this},stop:function(){return window.cancelAnimationFrame(this.p.requestID),this},destroy:function(){this.stop(),this.clearEvents()},createStage:function(t){var e=this.p;t=o.extend(!0,{},{canvas:e.canvas,offCanvas:e.offCanvas,gameOwner:this},t);var a=new u(t);return this.pushStage(a),a},pushStage:function(t){var e=this.p;this.getStageByName(t.name)||(t.gameOwner=this,e.stageStack.push(t),e.stages[t.name]=t,this.sortStageIndex())},popStage:function(){var t=this.p,e=t.stageStack.pop();e&&(delete t.stages[e.name],this.sortStageIndex())},sortStageIndex:function(){for(var t=this.stageStack,e=t.length-1,a=0;e>=0;e--,a++)t[e].zIndex=a},removeStageByName:function(t){var e=this.getStageByName(t),a=this.p;if(e){delete a.stages[e.name];var n=a.stageStack;o.removeArrByCondition(n,function(e){return e.name===t}),this.sortStageIndex()}},getCurrentStage:function(){var t=this.p;return t.stageStack[0]},getStageStack:function(){return this.p.stageStack},getStageByName:function(t){return this.p.stages[t]},changeStage:function(t){var e=this.p;if(t){for(var a=e.stageStack,n=-1,r=0,i=a.length;i>r;r++)if(a[r].name===t){n=r;break}this.swapStage(n,0)}},swapStage:function(t,e){var a=this.p,n=a.stageStack,r=n.length;if(t>=0&&r-1>=t&&e>=0&&r-1>=e){var i=n[t];n[t]=n[e],n[e]=i,this.sortStageIndex()}a.ctx.clearRect(0,0,a.canvas.width,a.canvas.height)},getStageIndex:function(t){return t.zIndex},clearAllStage:function(){var t=this.p;t.stages={},t.stageStack=[]},loadOther:function(t,e,a,n){return c.loadOther(t,e,a,n)},loadImage:function(t,e,a,n){return c.loadImage(t,e,a,n)},loadResource:function(t,e,a){return c.loadResource(t,e,a)}},o.inherits(e,i),e}),a("ig/Stage",["require","./Event","./util","./domEvt"],function(t){function e(t){return this.p={},n.extend(!0,this.p,{name:"ig_stage_"+r++,canvas:t.canvas,ctx:t.canvas.getContext("2d"),offCanvas:t.offCanvas,offCtx:t.offCanvas.getContext("2d"),width:t.gameOwner.width,height:t.gameOwner.height,cssWidth:t.gameOwner.cssWidth,cssHeight:t.gameOwner.cssHeight},t),this.p.displayObjectList=[],this.p.displayObjects={},console.warn(this),a.apply(this,this.p),this}var a=t("./Event"),n=t("./util"),r=(t("./domEvt"),0);return n.inherits(e,a),e}),a("ig/Event",["require"],function(){function t(){this._events={}}var e="_observerGUID";return t.prototype={constructor:t,on:function(t,a){this._events||(this._events={});var n=this._events[t];return n||(n=this._events[t]=[]),a.hasOwnProperty(e)||(a[e]=+new Date),n.push(a),this},un:function(t,e){if(this._events){if(!e)return void(this._events[t]=[]);var a=this._events[t];if(a)for(var n=0;n<a.length;n++)a[n]===e&&(a.splice(n,1),n--);return this}},fire:function(t,a){1===arguments.length&&"object"==typeof t&&(a=t,t=a.type);var n=this["on"+t];if("function"==typeof n&&n.call(this,a),this._events){null==a&&(a={}),"[object Object]"!==Object.prototype.toString.call(a)&&(a={data:a}),a.type=t,a.target=this;var r={},i=this._events[t];if(i){i=i.slice();for(var o=0;o<i.length;o++){var s=i[o];r.hasOwnProperty(s[e])||s.call(this,a)}}if("*"!==t){var u=this._events["*"];if(!u)return;u=u.slice();for(var o=0;o<u.length;o++){var s=u[o];r.hasOwnProperty(s[e])||s.call(this,a)}}}},clearEvents:function(){this._events={}},enable:function(e){e._events={},e.on=t.prototype.on,e.un=t.prototype.un,e.fire=t.prototype.fire}},t}),a("ig/domEvt",["require","./util","./env"],function(t){function e(t){for(var e=0,a=o.length;a>e;e++)if(o[e].name===t)return!0;return!1}var a=t("./util"),n=t("./env"),r=["touchstart","touchmove","touchend"],i=["mousedown","mousemove","mouseup"],o=[],s={};return s.events=n.supportTouch?r:i,s.fireEvt={},s.fireEvt.touchstart=s.fireEvt.mousedown=function(t){for(var e=t.target,a=e.displayObjectList,n=0,r=a.length;r>n;n++){var i=a[n];i.mouseEnable&&i.hitTestPoint&&i.hitTestPoint(t.data.x,t.data.y)&&(t.data.curStage=e,i.isCapture=!0,i.captureFunc.call(i,t.data))}return e},s.fireEvt.touchmove=s.fireEvt.mousemove=function(t){for(var a=t.target,n=a.displayObjectList,r=0,i=n.length;i>r;r++){var s=n[r];s.hitTestPoint&&s.hitTestPoint(t.data.x,t.data.y)&&!e(s.name)&&o.push(s),t.data.holdSprites=o,s.mouseEnable&&s.isCapture&&(t.data.curStage=a,s.moveFunc.call(s,t.data))}return a},s.fireEvt.touchend=s.fireEvt.mouseup=function(t){for(var a=t.target,n=a.displayObjectList,r=0,i=n.length;i>r;r++){var s=n[r];(s.isCapture||e(s.name))&&(s.releaseFunc.call(s,t.data),s.isCapture=!1)}return o=[],a},s.initMouse=function(t){this.stage=t,this.element=t.canvas,this.x=0,this.y=0,this.isDown=!1;var e=a.getElementOffset(this.element);return this.offsetX=e.x,this.offsetY=e.y,this.addEvent(),this},s.addEvent=function(){var t=this,e=t.element;t.events.forEach(function(a,n){e.addEventListener(a,function(e){e.preventDefault(),0===n?t.isDown=!0:2==n&&(t.isDown=!1);var r=e.changedTouches?e.changedTouches[0].pageX:e.pageX,i=e.changedTouches?e.changedTouches[0].pageY:e.pageY;t.x=r-t.offsetX,t.y=i-t.offsetY,t.stage.fire(a,{data:{x:t.x,y:t.y,isDown:t.isDown}})})})},s}),a("ig/resourceLoader",["require","./ig","./util"],function(t){function e(t){var e=t.split(".");return e[e.length-1].toLowerCase()}var a=t("./ig"),n=t("./util"),r={png:"Image",jpg:"Image",gif:"Image",jpeg:"Image",ogg:"Audio",wav:"Audio",m4a:"Audio",mp3:"Audio"},i={};return a.resources=i.resources={},a.loadOther=i.loadOther=function(){var t,a,r,i,o=arguments.length;switch(o){case 1:t=a=arguments[0],r=i=n.noop;break;case 2:t=a=arguments[0],r=i=arguments[1];break;case 3:t=a=arguments[0],r=arguments[1],i=arguments[2];break;default:t=arguments[0],a=arguments[1],r=arguments[2],i=arguments[3]}var s=e(a),u=new XMLHttpRequest;u.onreadystatechange=function(){4===u.readyState&&(200===u.status?"json"===s?r(t,JSON.parse(u.responseText)):r(t,u.responseText):i(a))},u.open("GET",a,!0),u.send(null)},a.loadImage=i.loadImage=function(){var t,e,a,r,i=arguments.length;switch(i){case 1:t=e=arguments[0],a=r=n.noop;break;case 2:t=e=arguments[0],a=r=arguments[1];break;case 3:t=e=arguments[0],a=arguments[1],r=arguments[2];break;default:t=arguments[0],e=arguments[1],a=arguments[2],r=arguments[3]}var o=new Image;o.addEventListener("load",function(){a(t,o)}),o.addEventListener("error",function(){r(e)}),o.src=e},a.loadResource=i.loadResource=function(t,i,o){var s=this;o=o||{},Array.isArray(t)||(t=[t]);for(var u=!1,c=function(t){u=!0,(o.errorCallback||function(t){throw"Loading Error: "+t}).call(s,t)},h=o.processCallback||n.noop,p=t.length,d=p,l=function(t,e){u||(a.resources[t]||(a.resources[t]=e),d--,h(p-d,p),0===d&&i&&i.call(s,a.resources))},f=o.customResourceTypes||{},m=n.extend({},r,f),g=0;p>g;g++){var v,w,y=t[g];if("object"===n.getType(y)?(v=y.id,w=y.src):v=w=y,a.resources.hasOwnProperty(v))l(v,a.resources[v]);else{var S=s["load"+m[e(w)]];S||(S=s.loadOther),S(v,w,l,c)}}},i});var n,r=e("ig"),i="ig/util",o="util",s="";s?r[s]?r[s][o]=e(i):(n={},n[o]=e(i),r[s]=n):(n=e(i),o&&(r[o]=n));var n,i="ig/easing",o="easing",s="";s?r[s]?r[s][o]=e(i):(n={},n[o]=e(i),r[s]=n):(n=e(i),o&&(r[o]=n));var n,i="ig/env",o="env",s="";s?r[s]?r[s][o]=e(i):(n={},n[o]=e(i),r[s]=n):(n=e(i),o&&(r[o]=n));var n,i="ig/Animation",o="Animation",s="";s?r[s]?r[s][o]=e(i):(n={},n[o]=e(i),r[s]=n):(n=e(i),o&&(r[o]=n));var n,i="ig/Vector",o="Vector",s="";s?r[s]?r[s][o]=e(i):(n={},n[o]=e(i),r[s]=n):(n=e(i),o&&(r[o]=n));var n,i="ig/Game",o="Game",s="";s?r[s]?r[s][o]=e(i):(n={},n[o]=e(i),r[s]=n):(n=e(i),o&&(r[o]=n));var n,i="ig/Stage",o="Stage",s="";s?r[s]?r[s][o]=e(i):(n={},n[o]=e(i),r[s]=n):(n=e(i),o&&(r[o]=n));var n,i="ig/Event",o="",s="";s?r[s]?r[s][o]=e(i):(n={},n[o]=e(i),r[s]=n):(n=e(i),o&&(r[o]=n));var n,i="ig/domEvt",o="",s="";s?r[s]?r[s][o]=e(i):(n={},n[o]=e(i),r[s]=n):(n=e(i),o&&(r[o]=n));var n,i="ig/resourceLoader",o="",s="";s?r[s]?r[s][o]=e(i):(n={},n[o]=e(i),r[s]=n):(n=e(i),o&&(r[o]=n)),t.ig=r}(window);