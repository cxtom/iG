!function(t){var e,i;!function(){function t(t,e){if(!e)return t;if(0===t.indexOf(".")){var i=e.split("/"),n=t.split("/"),s=i.length-1,r=n.length,a=0,o=0;t:for(var h=0;r>h;h++)switch(n[h]){case"..":if(!(s>a))break t;a++,o++;break;case".":o++;break;default:break t}return i.length=s-a,n=n.slice(o),i.concat(n).join("/")}return t}function n(e){function i(i,a){if("string"==typeof i){var o=n[i];return o||(o=r(t(i,e)),n[i]=o),o}i instanceof Array&&(a=a||function(){},a.apply(this,s(i,a,e)))}var n={};return i}function s(i,n,s){for(var o=[],h=a[s],c=0,u=Math.min(i.length,n.length);u>c;c++){var l,f=t(i[c],s);switch(f){case"require":l=h&&h.require||e;break;case"exports":l=h.exports;break;case"module":l=h;break;default:l=r(f)}o.push(l)}return o}function r(t){var e=a[t];if(!e)throw new Error("No "+t);if(!e.defined){var i=e.factory,n=i.apply(this,s(e.deps||[],i,t));"undefined"!=typeof n&&(e.exports=n),e.defined=1}return e.exports}var a={};i=function(t,e,i){a[t]={id:t,deps:e,factory:i,defined:0,exports:{},require:n(t)}},e=n("")}(),i("ig",["ig/ig"],function(t){return t}),i("ig/ig",["require"],function(){"use strict";window.requestAnimationFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame||window.oRequestAnimationFrame||function(t){var e,i,n=this;setTimeout(function(){e=+new Date,t(e),i=+new Date,n.timeout=1e3/60-(i-e)},n.timeout)}}(),window.cancelAnimationFrame=function(){return window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.webkitCancelRequestAnimationFrame||window.mozCancelAnimationFrame||window.mozCancelRequestAnimationFrame||window.msCancelAnimationFrame||window.msCancelRequestAnimationFrame||window.oCancelAnimationFrame||window.oCancelRequestAnimationFrame||window.clearTimeout}();var t={};return t}),i("ig/util",["require"],function(){"use strict";var t=Math.PI/180,e=180/Math.PI,i=Object.prototype,n={};return n.noop=function(){},n.extend=function(t,e){for(var i=1,n=arguments.length;n>i;i++)if(e=arguments[i])for(var s in e)e.hasOwnProperty(s)&&(t[s]=e[s]);return t},n.inherits=function(t,e){var i=function(){};i.prototype=e.prototype;var n=t.prototype,s=t.prototype=new i;for(var r in n)s[r]=n[r];return t.prototype.constructor=t,t.superClass=e.prototype,t},n.deg2Rad=function(e){return e*t},n.rad2Deg=function(t){return t*e},n.window2Canvas=function(t,e,i){var n=t.getBoundingClientRect();return{x:Math.round(e-n.left*(t.width/n.width)),y:Math.round(i-n.top*(t.height/n.height))}},n.fastApply=function(t,e,i){switch(i.length){case 0:return t.call(e);case 1:return t.call(e,i[0]);case 2:return t.call(e,i[0],i[1]);case 3:return t.call(e,i[0],i[1],i[2]);case 4:return t.call(e,i[0],i[1],i[2],i[3]);case 5:return t.call(e,i[0],i[1],i[2],i[3],i[4]);case 6:return t.call(e,i[0],i[1],i[2],i[3],i[4],i[5]);case 7:return t.call(e,i[0],i[1],i[2],i[3],i[4],i[5],i[6]);case 8:return t.call(e,i[0],i[1],i[2],i[3],i[4],i[5],i[6],i[7]);case 9:return t.call(e,i[0],i[1],i[2],i[3],i[4],i[5],i[6],i[7],i[8]);default:return t.apply(e,i)}},n.removeArrByCondition=function(t,e){for(var i,n=-1,s=0,r=t.length;r>s;s++)if(i=t[s],e(i)){n=s;break}-1!==n&&t.splice(n,1)},n.parseColor=function(t,e){return e===!0?"number"==typeof t?0|t:("string"==typeof t&&"#"===t[0]&&(t=t.slice(1)),parseInt(t,16)):("number"==typeof t&&(t="#"+("00000"+(0|t).toString(16)).substr(-6)),t)},n.colorToRGB=function(t,e){"string"==typeof t&&"#"===t[0]&&(t=window.parseInt(t.slice(1),16)),e=void 0===e?1:e;var i=t>>16&255,n=t>>8&255,s=255&t,r=0>e?0:e>1?1:e;return 1===r?"rgb("+i+","+n+","+s+")":"rgba("+i+","+n+","+s+","+r+")"},n.randomInt=function(t,e){return Math.floor(Math.random()*(e-t+1)+t)},n.randomFloat=function(t,e){return Math.random()*(e-t)+t},n.domWrap=function(t,e,i){return t.parentNode.insertBefore(e,t),e.appendChild(t),e.id=i,t},n.getType=function(t){var e=i.toString.call(t),n=/\[object (\w+)\]/.exec(e);return n[1].toLowerCase()},n.getMouseCoords=function(t,e){var i=t.getBoundingClientRect(),n=i.top,s=i.bottom,r=i.left,a=i.right,o=getComputedStyle(t,null);if(o){var h=parseInt(o.getPropertyValue("border-top-width"),10),c=parseInt(o.getPropertyValue("border-right-width"),10),u=parseInt(o.getPropertyValue("border-bottom-width"),10),l=parseInt(o.getPropertyValue("border-left-width"),10);r+=l,a-=c,n+=h,s-=u}var f={};f.x=e.clientX-r,f.y=e.clientY-n;var d=a-r;if(t.width!==d){var p=s-n;f.x=f.x*(t.width/d),f.y=f.y*(t.height/p)}return f},n.captureMouse=function(t){var e={x:0,y:0,event:null},i=document.body.scrollLeft,n=document.documentElement.scrollLeft,s=document.body.scrollTop,r=document.documentElement.scrollTop,a=t.offsetLeft,o=t.offsetTop;return t.addEventListener("mousemove",function(t){var h,c;t.pageX||t.pageY?(h=t.pageX,c=t.pageY):(h=t.clientX+i+n,c=t.clientY+s+r),h-=a,c-=o,e.x=h,e.y=c,e.event=t,console.warn(e)},!1),e},n.captureTouch=function(t){var e={x:null,y:null,isPressed:!1,event:null},i=document.body.scrollLeft,s=document.documentElement.scrollLeft,r=document.body.scrollTop,a=document.documentElement.scrollTop,o=t.offsetLeft,h=t.offsetTop;return t.addEventListener("touchstart",function(t){e.isPressed=!0,e.event=t,console.warn(e,"touchstart")},!1),t.addEventListener("touchend",function(t){e.isPressed=!1,e.x=null,e.y=null,e.event=t,console.warn(e,"touchend")},!1),t.addEventListener("touchmove",function(t){var c,u,l=t.touches[0];l.pageX||l.pageY?(c=l.pageX,u=l.pageY):(c=l.clientX+i+s,u=l.clientY+r+a),c-=o,u-=h,e.x=c,e.y=u,e.event=t,console.log(n.getMouseCoords(e.event.target,l))},!1),e},n.getElementOffset=function(t){for(var e=t.offsetLeft,i=t.offsetTop;(t=t.offsetParent)&&t!=document.body&&t!=document;)e+=t.offsetLeft,i+=t.offsetTop;return{x:e,y:i}},n.isEmptyObject=function(t){if("object"!==n.getType(t))return!1;var e;for(e in t)return!1;return!0},n}),i("ig/Event",["require"],function(){"use strict";function t(){this._events={}}var e="_observerGUID";return t.prototype={constructor:t,on:function(t,i){this._events||(this._events={});var n=this._events[t];return n||(n=this._events[t]=[]),i.hasOwnProperty(e)||(i[e]=+new Date),n.push(i),this},un:function(t,e){if(this._events){if(!e)return void(this._events[t]=[]);var i=this._events[t];if(i)for(var n=0;n<i.length;n++)i[n]===e&&(i.splice(n,1),n--);return this}},fire:function(t,i){1===arguments.length&&"object"==typeof t&&(i=t,t=i.type);var n=this["on"+t];if("function"==typeof n&&n.call(this,i),this._events){null==i&&(i={}),"[object Object]"!==Object.prototype.toString.call(i)&&(i={data:i}),i.type=t,i.target=this;var s={},r=this._events[t];if(r){r=r.slice();for(var a=0;a<r.length;a++){var o=r[a];s.hasOwnProperty(o[e])||o.call(this,i)}}if("*"!==t){var h=this._events["*"];if(!h)return;h=h.slice();for(var a=0;a<h.length;a++){var o=h[a];s.hasOwnProperty(o[e])||o.call(this,i)}}}},enable:function(e){e._events={},e.on=t.prototype.on,e.un=t.prototype.un,e.fire=t.prototype.fire}},t}),i("ig/env",["require"],function(){"use strict";function t(t){var e={},i={},n=t.match(/Web[kK]it[\/]{0,1}([\d.]+)/),s=t.match(/(Android);?[\s\/]+([\d.]+)?/),r=!!t.match(/\(Macintosh\; Intel /),a=t.match(/(iPad).*OS\s([\d_]+)/),o=t.match(/(iPod)(.*OS\s([\d_]+))?/),h=!a&&t.match(/(iPhone\sOS)\s([\d_]+)/),c=t.match(/(webOS|hpwOS)[\s\/]([\d.]+)/),u=t.match(/Windows Phone ([\d.]+)/),l=c&&t.match(/TouchPad/),f=t.match(/Kindle\/([\d.]+)/),d=t.match(/Silk\/([\d._]+)/),p=t.match(/(BlackBerry).*Version\/([\d.]+)/),g=t.match(/(BB10).*Version\/([\d.]+)/),v=t.match(/(RIM\sTablet\sOS)\s([\d.]+)/),m=t.match(/PlayBook/),y=t.match(/Chrome\/([\d.]+)/)||t.match(/CriOS\/([\d.]+)/),w=t.match(/Firefox\/([\d.]+)/),b=t.match(/MSIE\s([\d.]+)/)||t.match(/Trident\/[\d](?=[^\?]+).*rv:([0-9.].)/),x=!y&&t.match(/(iPhone|iPod|iPad).*AppleWebKit(?!.*Safari)/),S=x||t.match(/Version\/([\d.]+)([^S](Safari)|[^M]*(Mobile)[^S]*(Safari))/),I=t.match(/MicroMessenger\/([\d.]+)/),C=t.match(/baiduboxapp\/[^\/]+\/([\d.]+)_/)||t.match(/baiduboxapp\/([\d.]+)/)||t.match(/BaiduHD\/([\d.]+)/)||t.match(/FlyFlow\/([\d.]+)/)||t.match(/baidubrowser\/([\d.]+)/),O=t.match(/MQQBrowser\/([\d.]+)/)||t.match(/QQ\/([\d.]+)/),M=t.match(/UCBrowser\/([\d.]+)/),P=t.match(/SogouMobileBrowser\/([\d.]+)/),k=s&&t.match(/MiuiBrowser\/([\d.]+)/),F=t.match(/LBKIT/),E=t.match(/Mercury\/([\d.]+)/);return(i.webkit=!!n)&&(i.version=n[1]),s&&(e.android=!0,e.version=s[2]),h&&!o&&(e.ios=e.iphone=!0,e.version=h[2].replace(/_/g,".")),a&&(e.ios=e.ipad=!0,e.version=a[2].replace(/_/g,".")),o&&(e.ios=e.ipod=!0,e.version=o[3]?o[3].replace(/_/g,"."):null),u&&(e.wp=!0,e.version=u[1]),c&&(e.webos=!0,e.version=c[2]),l&&(e.touchpad=!0),p&&(e.blackberry=!0,e.version=p[2]),g&&(e.bb10=!0,e.version=g[2]),v&&(e.rimtabletos=!0,e.version=v[2]),m&&(i.playbook=!0),f&&(e.kindle=!0,e.version=f[1]),d&&(i.silk=!0,i.version=d[1]),!d&&e.android&&t.match(/Kindle Fire/)&&(i.silk=!0),y&&(i.chrome=!0,i.version=y[1]),w&&(i.firefox=!0,i.version=w[1]),b&&(i.ie=!0,i.version=b[1]),S&&(r||e.ios)&&(i.safari=!0,r&&(i.version=S[1])),x&&(i.webview=!0),I&&(i.wechat=!0,i.version=I[1]),C&&(delete i.webview,i.baidu=!0,i.version=C[1]),O&&(i.qq=!0,i.version=O[1]),M&&(delete i.webview,i.uc=!0,i.version=M[1]),P&&(delete i.webview,i.sogou=!0,i.version=P[1]),k&&(i.xiaomi=!0,i.version=k[1]),F&&(i.liebao=!0,i.version="0"),E&&(i.mercury=!0,i.version=E[1]),navigator.standalone&&(i.standalone=!0),e.tablet=!!(a||m||s&&!t.match(/Mobile/)||w&&t.match(/Tablet/)||b&&!t.match(/Phone/)&&t.match(/Touch/)),e.phone=!(e.tablet||e.ipod||!(s||h||c||p||g||y&&t.match(/Android/)||y&&t.match(/CriOS\/([\d.]+)/)||w&&t.match(/Mobile/)||b&&t.match(/Touch/))),{browser:i,os:e}}function e(t){t.audioData=!!window.Audio,t.webAudio=!(!window.AudioContext&&!window.webkitAudioContext);var e=document.createElement("audio"),i=!1;try{(i=!!e.canPlayType)&&(e.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,"")&&(t.ogg=!0),(e.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,"")||e.canPlayType("audio/opus;").replace(/^no$/,""))&&(t.opus=!0),e.canPlayType("audio/mpeg;").replace(/^no$/,"")&&(t.mp3=!0),e.canPlayType('audio/wav; codecs="1"').replace(/^no$/,"")&&(t.wav=!0),(e.canPlayType("audio/x-m4a;")||e.canPlayType("audio/aac;").replace(/^no$/,""))&&(t.m4a=!0),e.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")&&(t.webm=!0))}catch(n){}}var i=t(navigator.userAgent),n={browser:i.browser,os:i.os,supportOrientation:"number"==typeof window.orientation&&"object"==typeof window.onorientationchange,supportTouch:"ontouchstart"in window||window.DocumentTouch&&document instanceof window.DocumentTouch,supportGeolocation:null!=navigator.geolocation,isAndroid:i.os.android,isIOS:i.os.ios,isPhone:i.os.phone,isTablet:i.os.tablet,isMobile:i.os.phone||i.os.tablet};return e(n),n}),i("ig/Game",["require","./Event","./util","./env","./Stage"],function(t){"use strict";function e(){var t=this,e=window.innerWidth,n=window.innerHeight,s=e/n,r=t.canvas.width/t.canvas.height,a=s>r?n/t.canvas.height:e/t.canvas.width,o=t.canvas.width*a,h=t.canvas.height*a;if(t.canvas.style.width=o+"px",t.canvas.style.height=h+"px",t.canvas.parentNode&&(t.canvas.parentNode.style.width=o+"px",t.canvas.parentNode.style.height=h+"px"),r>=s){var c=(n-h)/2;t.canvas.style.top=c+"px"}t.width=t.canvas.width,t.cssWidth=t.canvas.style.width,t.height=t.canvas.height,t.cssHeight=t.canvas.style.height,t.scaleRatio=a,i.call(t)}function i(){this.offCanvas||(this.offCanvas=document.createElement("canvas"),this.offCtx=this.offCanvas.getContext("2d")),this.offCanvas.width=this.canvas.width,this.offCanvas.style.width=this.canvas.style.width,this.offCanvas.height=this.canvas.height,this.offCanvas.style.height=this.canvas.style.height}function n(t){t=t||{},f.apply(this,arguments),this.name=null===t.name||void 0===t.name?"ig_game_"+v++:t.name,this.paused=!1,this.stageStack=[],this.stages={},m=t.fps||60}var s,r,a,o,h,c,u,l,f=t("./Event"),d=t("./util"),p=t("./env"),g=t("./Stage"),v=0,m=60;return n.prototype={constructor:n,init:function(t){var n=this;if(!t.canvas)throw new Error("Game init must be require a canvas param");n.canvas=d.domWrap(t.canvas,document.createElement("div"),"ig-stage-container"+v),n.canvas.width=t.width||320,n.canvas.height=t.height||480;var s=parseInt(n.canvas.width,10),r=parseInt(n.canvas.height,10),a=t.maxWidth||5e3,o=t.maxHeight||5e3;if(t.maximize){document.body.style.padding=0,document.body.style.margin=0;var h,c=d.getType(t.pageScroll);h="number"===c?t.pageScroll:"boolean"===c?17:0,s=t.width||Math.min(window.innerWidth,a)-h,r=t.height||Math.min(window.innerHeight-5,o)}p.supportTouch&&(n.canvas.style.height=2*r+"px",window.scrollTo(0,1),s=Math.min(window.innerWidth,a),r=Math.min(window.innerHeight,o)),n.ctx=n.canvas.getContext("2d"),n.canvas.style.height=r+"px",n.canvas.style.width=s+"px",n.canvas.width=s,n.canvas.height=r,n.canvas.style.position="relative",n.width=n.canvas.width,n.cssWidth=n.canvas.style.width,n.height=n.canvas.height,n.cssHeight=n.canvas.style.height,i.call(n);var u=n.canvas.parentNode;return u.style.width=s+"px",u.style.margin="0 auto",u.style.position="relative",t.scaleFit&&e.call(n),window.addEventListener(p.supportOrientation?"orientationchange":"resize",function(){setTimeout(function(){window.scrollTo(0,1),t.scaleFit&&e.call(n)},0)},!1),n},start:function(){var t=this;t.paused=!1,r=Date.now(),s=0,a=1e3/m,o=0,h=Date.now(),c=0,u=0,l=0;var e="",i=d.noop,n=arguments.length;switch(n){case 1:"function"===d.getType(arguments[0])?i=arguments[0]:(e=arguments[0],i=d.noop);break;case 2:e=arguments[0],i=arguments[1]}if(e){for(var f=t.stageStack,p=-1,g=0,v=f.length;v>g;g++)if(f[g].name===e){p=g;break}t.swapStage(p,0)}return t.requestID=window.requestAnimationFrame(function(){t.render.call(t,e)}),"function"===d.getType(i)&&i.call(t,{data:{startTime:r,interval:a}}),t},render:function(){var t=this;if(t.requestID=window.requestAnimationFrame(function(t){return function(){t.render.call(t)}}(t)),!t.paused){if(s=Date.now(),o=s-r,o>a){l++,r=s-o%a,t.fire("beforeGameRender",{data:{startTime:r,totalFrameCounter:l}});var e=t.getCurrentStage();e&&(e.update(l,o),e.render()),t.fire("afterGameRender",{data:{startTime:r,totalFrameCounter:l}})}u>1e3?(h=Date.now(),u=0,t.fire("gameFPS",{data:{fps:c,totalFrameCounter:l}}),c=0):(u=Date.now()-h,++c)}},pause:function(){return this.paused=!0,this},resume:function(){return this.paused=!1,this},stop:function(){return window.cancelAnimationFrame(this.requestID),this},getStageStack:function(){return this.stageStack},getStageByName:function(t){return this.stages[t]},createStage:function(t){var e=this;t=d.extend({},{canvas:e.canvas,offCanvas:e.offCanvas,game:e},t);var i=new g(t);return this.pushStage(i),i},pushStage:function(t){var e=this;e.getStageByName(t.name)||(t.gameOwner=e,e.stageStack.push(t),e.stages[t.name]=t,e.sortStageIndex())},popStage:function(){var t=this,e=t.stageStack.pop();e&&(delete t.stages[e.name],t.sortStageIndex())},sortStageIndex:function(){for(var t=this.stageStack,e=t.length-1,i=0;e>=0;e--,i++)t[e].zIndex=i},removeStageByName:function(t){var e=this,i=e.getStageByName(t);if(i){delete e.stages[i.name];var n=e.stageStack;d.removeArrByCondition(n,function(e){return e.name===t}),e.sortStageIndex()}},changeStage:function(t){var e=this;if(t){for(var i=e.stageStack,n=-1,s=0,r=i.length;r>s;s++)if(i[s].name===t){n=s;break}e.swapStage(n,0)}},swapStage:function(t,e){var i=this,n=i.stageStack,s=n.length;if(t>=0&&s-1>=t&&e>=0&&s-1>=e){var r=n[t];n[t]=n[e],n[e]=r,i.sortStageIndex()}i.ctx.clearRect(0,0,i.canvas.width,i.canvas.height)},getStageIndex:function(t){return t.zIndex},getCurrentStage:function(){var t=this;return t.stageStack[0]},clearAllStage:function(){for(var t=this,e=0,i=t.stageStack.length;i>e;e++)t.stageStack[e].clean();t.stages={},t.stageStack=[]}},d.inherits(n,f),n}),i("ig/Stage",["require","./Event","./util","./DisplayObject","./domEvt"],function(t){"use strict";function e(t){var e=this;t.save(),t.fillStyle=t.createPattern(e.image,e.repeat),t.fillRect(e.x,e.y,t.canvas.width,t.canvas.height),t.restore(),u.src||(u.src=t.canvas.toDataURL(),e.image=u)}function i(t,e,i,n,s,r){var a=this,o=Math.abs(n.x)%s,h=Math.abs(n.y)%r,c=n.x<0?s-o:o,u=n.y<0?r-h:h,l=i.width<s-c?i.width:s-c,f=i.height<r-u?i.height:r-u;return t.drawImage(a.image,c,u,l,f,e.x,e.y,l,f),{width:l,height:f}}function n(){var t=this,n=t.parallax;if(n){var s=t.offCtx;"no-repeat"!==n.repeat&&e.call(n,s);for(var r=n.image.width,a=n.image.height,o={width:0,height:0},h=0;a>h;h+=o.height)for(var c=0;r>c;c+=o.width){var u={x:n.x+c,y:n.y+h},l={width:r-c,height:a-h},f={x:0,y:0};0===c&&(f.x=n.vX),0===h&&(f.y=n.vY),o=i.call(n,s,u,l,f,r,a)}}}function s(t){var e=this,i=e.parallax;i&&(i.anims&&"array"===o.getType(i.anims)?(i.animInterval=i.animInterval||1e4,i.curAnim||(i.curAnim=i.anims[0]),t%i.animInterval===0&&(void 0===i.time&&(i.time=0),i.time++,i.time===i.anims.length&&(i.time=0),i.curAnim=i.anims[i.time])):i.curAnim={aX:i.aX,aY:i.aY},i.vX=(i.vX+i.curAnim.aX)%i.image.width,i.vY=(i.vY+i.curAnim.aY)%i.image.height)}function r(t){return a.apply(this,arguments),t=t||{},this.name=null===t.name||void 0===t.name?"ig_stage_"+l++:t.name,this.displayObjectList=[],this.displayObjects={},this.canvas=t.canvas,this.ctx=t.canvas.getContext("2d"),this.offCanvas=t.offCanvas,this.offCtx=t.offCanvas.getContext("2d"),this.width=t.game.width,this.height=t.game.height,this.cssWidth=t.game.cssWidth,this.cssHeight=t.game.cssHeight,this.initMouseEvent(),this}var a=t("./Event"),o=t("./util"),h=t("./DisplayObject"),c=t("./domEvt"),u=new Image,l=0;return r.prototype={constructor:r,initMouseEvent:function(){c.initMouse(this),this.bindMouseEvent()},bindMouseEvent:function(){var t=this;return c.events.forEach(function(e){var i=c.fireEvt[e];i&&t.on(e,i)}),t},clear:function(){var t=this;return t.offCtx.clearRect(0,0,t.width,t.height),t},setBgColor:function(t){var e=this;return e.bgColor=t,e},setBgImg:function(t,e){var i,n=this;"htmlimageelement"===o.getType(t)?i=t.src:"string"===o.getType(t)&&(i=t);var s="url("+i+")",r="",a="",h="";switch(e){case"center":r="no-repeat",a="center";break;case"full":h=n.cssWidth+"px "+n.cssHeight+"px"}return n.bgImg={bgUrl:s,bgRepeat:r,bgPos:a,bgSize:h},n},setParallaxScroll:function(t){var e=this;if(t=t||{},!t.image)throw new Error("ParallaxScroll must be require a image param");return t.repeat=t.repeat&&-1!==["repeat","repeat-x","repeat-y"].indexOf(t.repeat)?t.repeat:"no-repeat",e.parallax=o.extend({},{x:0,y:0,vX:0,vY:0,aX:0,aY:0},t),this},update:function(t,e){s.call(this,t);for(var i,n=this.displayObjectList,r=n.length,a=0;r>a;a++){var o=this.displayObjectList[a];o&&(i=o.status,(1===i||2===i)&&o.update(e))}},render:function(){var t=this;t.clear(),t.fire("beforeStageRender"),t.offCtx.save(),t.offCtx.clearRect(0,0,t.offCanvas.width,t.offCanvas.height),t.canvas.style.backgroundColor=t.bgColor?t.bgColor:"",t.bgImg?(t.canvas.style.backgroundImage=t.bgImg.bgUrl,t.canvas.style.backgroundRepeat=t.bgImg.bgRepeat,t.canvas.style.backgroundPosition=t.bgImg.bgPos,t.canvas.style.backgroundSize=t.bgImg.bgSize):t.canvas.style.backgroundImage="",n.call(t),t.sortDisplayObject();for(var e,i=t.displayObjectList,s=i.length,r=0;s>r;r++){var a=this.displayObjectList[r];a&&(e=a.status,5===e?this.removeDisplayObject(a):(1===e||3===e)&&a.render(t.offCtx))}t.offCtx.restore(),t.ctx.drawImage(t.offCanvas,0,0),t.fire("afterStageRender")},sortDisplayObject:function(){this.displayObjectList.sort(function(t,e){return t.zIndex-e.zIndex})},getDisplayObjectList:function(){return this.displayObjectList},getDisplayObjectByName:function(t){return this.displayObjects[t]},createDisplayObject:function(t){var e=new h(t);return this.addDisplayObject(e),e},addDisplayObject:function(t){var e=this;t&&!e.getDisplayObjectByName(t.name)&&(t.stageOwner=e,e.displayObjectList.push(t),e.displayObjects[t.name]=t)},removeDisplayObject:function(t){t&&this.removeDisplayObjectByName(t.name)},removeDisplayObjectByName:function(t){var e=this,i=e.displayObjects[t];if(i){delete e.displayObjects[i.name];var n=e.displayObjectList;o.removeArrByCondition(n,function(e){return e.name===t})}},clearAllDisplayObject:function(){this.displayObjectList=[],this.displayObjects={}}},o.inherits(r,a),r}),i("ig/DisplayObject",["require","./Event","./util"],function(t){"use strict";function e(t){t=t||{},i.apply(this,arguments),this.name=null===t.name||void 0===t.name?"ig_displayobject_"+s++:t.name,this.stageOwner=null,this.x=t.x||0,this.y=t.y||0,this.width=t.width||0,this.height=t.height||0,this.radius=t.radius||0,this.scaleX=t.scaleX||1,this.scaleY=t.scaleY||1,this.angle=t.angle||0,this.alpha=t.alpha||1,this.zIndex=t.zIndex||0,this.fillStyle=t.fillStyle||null,this.strokeStyle=t.strokeStyle||null,this.image=t.image||null,this.vX=t.vX||0,this.vY=t.vY||0,this.aX=t.aX||0,this.aY=t.aY||0,this.frictionX=t.frictionX||1,this.frictionY=t.frictionY||1,this.reverseVX=!1,this.reverseVY=!1,this.status=1,this.c=t.c||{},this.mouseEnable=!!t.mouseEnable||!1,this.debug=!!t.debug||!1,this.captureFunc=t.captureFunc||n.noop,this.moveFunc=t.moveFunc||n.noop,this.releaseFunc=t.releaseFunc||n.noop,this.setPos(this.x,this.y)}var i=t("./Event"),n=t("./util"),s=0;return e.prototype={constructor:e,changeStatus:function(t){return this.status=t||this.status,this},setCaptureFunc:function(t){return this.captureFunc=t||n.noop,this},setMoveFunc:function(t){return this.moveFunc=t||n.noop,this},setReleaseFunc:function(t){return this.releaseFunc=t||n.noop,this},setPos:function(t,e){this.x=t||0,this.y=e||t||0},setAcceleration:function(t,e){this.aX=t||this.aX,this.aY=e||this.aY},setAccelerationX:function(t){this.aX=t||this.aX},setAccelerationY:function(t){this.aY=t||this.aY},resetAcceleration:function(){this.aX=0,this.aY=0},move:function(t,e){this.x+=t,this.y+=e},moveStep:function(){this.vX+=this.aX,this.vX*=this.frictionX,this.x+=this.vX,this.vY+=this.aY,this.vY*=this.frictionY,this.y+=this.vY},setFrictionX:function(t){this.frictionX=t},setFrictionY:function(t){this.frictionY=t},rotate:function(t){var e=this.stageOwner.offCtx;e.save(),e.rotate(n.deg2Rad(t||this.angle)),e.restore()},update:function(){return this},render:function(){return this}},n.inherits(e,i),e}),i("ig/SpriteSheet",["require","./util","./DisplayObject","./geom/polygon","./collision"],function(t){"use strict";function e(t){if(t=t||{},!t.image)throw new Error("SpriteSheet must be require a image param");return n.apply(this,arguments),i.extend(this,{name:"ig_spritesheet_"+o++,total:1,x:0,y:0,sX:0,sY:0,cols:0,rows:0,tileW:0,tileH:0,offsetX:0,offsetY:0,ticksPerFrame:0,isOnce:!1,onceDone:i.noop},t),this.tickUpdateCount=0,this.frameIndex=0,this.originalSX=this.sX,this.originalTotal=this.total,this.realCols=a(this.cols-this.sX/this.tileW),this.width=this.tileW,this.height=this.tileH,t.points&&t.points.length&&"array"===i.getType(t.points)?this.points=t.points:s.toPolygon(this),s.recalc(this),s.getBounds(this),this}var i=t("./util"),n=t("./DisplayObject"),s=t("./geom/polygon"),r=t("./collision"),a=Math.floor,o=0;return e.prototype={constructor:e,changeFrame:function(t){return i.extend(this,{total:this.total,x:this.x,y:this.y,sX:this.sX,sY:this.sY,cols:this.cols,rows:this.rows,tileW:0,tileH:0,offsetX:0,offsetY:0,ticksPerFrame:this.ticksPerFrame,isOnce:!1,onceDone:i.noop},t),this.tickUpdateCount=0,this.frameIndex=0,this.originalSX=this.sX,this.originalTotal=this.total,this.realCols=a(this.cols-this.sX/this.tileW),this.width=this.tileW,this.height=this.tileH,this},update:function(){if(this.tickUpdateCount++,this.tickUpdateCount>this.ticksPerFrame){if(this.tickUpdateCount=0,this.frameIndex<this.total-1)this.frameIndex++;else if(this.frameIndex=0,this.total=this.originalTotal,this.sX=this.originalSX,this.realCols=a(this.cols-this.originalSX/this.tileW),this.sY-=(this.rows-1)*this.tileH,this.isOnce&&(this.status=5,"function"===i.getType(this.onceDone))){var t=this;setTimeout(function(){t.onceDone(t)},100)}this.frameIndex===this.realCols&&(this.total-=this.realCols,this.frameIndex=0,this.sY+=this.tileH,this.sX=0,this.realCols=this.cols)}return this},render:function(t){return s.getBounds(this),t.save(),t.globalAlpha=this.alpha,t.translate(this.x,this.y),t.rotate(i.deg2Rad(this.angle)),t.scale(this.scaleX,this.scaleY),t.translate(-this.x,-this.y),t.drawImage(this.image,this.frameIndex*this.tileW+this.sX,this.sY,this.tileW,this.tileH,this.x+this.offsetX,this.y+this.offsetY,this.tileW,this.tileH),this.debugRender(t),t.restore(),this},hitTestPoint:function(t,e){return r.checkPointPolygon({x:t,y:e},this)},debugRender:function(t){if(this.debug){t.save(),t.strokeStyle="black";var e=this.points,i=e.length;for(t.translate(this.x,this.y),t.beginPath(),t.moveTo(e[0].x,e[0].y);i--;)t.lineTo(e[i].x,e[i].y);t.closePath(),t.stroke(),t.translate(-this.x,-this.y),t.restore()}}},i.inherits(e,n),e}),i("ig/resourceLoader",["require","./ig","./util"],function(t){function e(t){var e=t.split(".");return e[e.length-1].toLowerCase()}var i=t("./ig"),n=t("./util"),s={png:"Image",jpg:"Image",gif:"Image",jpeg:"Image",ogg:"Audio",wav:"Audio",m4a:"Audio",mp3:"Audio"};i.resources={},i.loadOther=function(){var t,i,s,r,a=arguments.length;switch(a){case 1:t=i=arguments[0],s=r=n.noop;break;case 2:t=i=arguments[0],s=r=arguments[1];break;case 3:t=i=arguments[0],s=arguments[1],r=arguments[2];break;default:t=arguments[0],i=arguments[1],s=arguments[2],r=arguments[3]}var o=e(i),h=new XMLHttpRequest;h.onreadystatechange=function(){4===h.readyState&&(200===h.status?"json"===o?s(t,JSON.parse(h.responseText)):s(t,h.responseText):r(i))},h.open("GET",i,!0),h.send(null)},i.loadImage=function(){var t,e,i,s,r=arguments.length;switch(r){case 1:t=e=arguments[0],i=s=n.noop;break;case 2:t=e=arguments[0],i=s=arguments[1];break;case 3:t=e=arguments[0],i=arguments[1],s=arguments[2];break;default:t=arguments[0],e=arguments[1],i=arguments[2],s=arguments[3]}var a=new Image;a.addEventListener("load",function(){i(t,a)}),a.addEventListener("error",function(){s(e)}),a.src=e},i.loadResource=function(t,r,a){var o=this;a=a||{},Array.isArray(t)||(t=[t]);for(var h=!1,c=function(t){h=!0,(a.errorCallback||function(t){throw"Loading Error: "+t}).call(o,t)},u=a.processCallback||n.noop,l=t.length,f=l,d=function(t,e){h||(i.resources[t]||(i.resources[t]=e),f--,u(l-f,l),0===f&&r&&r.call(o,i.resources))},p=a.customResourceTypes||{},g=n.extend({},s,p),v=0;l>v;v++){var m,y,w=t[v];"object"===n.getType(w)?(m=w.id,y=w.src):m=y=w;var b=o["load"+g[e(y)]];b||(b=o.loadOther),b(m,y,d,c)}}}),i("ig/Shape/Ball",["require","../util","../DisplayObject"],function(t){"use strict";function e(){var t=this;n.apply(t,arguments)}var i=t("../util"),n=t("../DisplayObject");return e.prototype={constructor:e,update:function(){var t=this,e=t.stageOwner.width,i=t.stageOwner.height;(t.x<t.radius||t.x>e-t.radius)&&(t.vX=-t.vX),(t.y<t.radius||t.y>i-t.radius)&&(t.vY=-t.vY),t.moveStep(),t.bBox.x=t.x,t.bBox.y=t.y},render:function(t){t.save(),t.beginPath(),t.fillStyle=this.color,t.arc(this.x,this.y,this.radius,0,2*Math.PI),t.fill(),t.restore(),this.bBox.color="red",this.checkCollide(),this.bBox.show(t)},setBBox:function(t){this.bBox=t},checkCollide:function(){for(var t=this,e=t.stageOwner.displayObjectList,i=e.length,n=0;i>n;n++)t.name!==e[n].name&&t.bBox.isCollide(e[n].bBox)&&"yellow"!==t.bBox.color&&(console.warn(1),t.bBox.color="yellow",e[n].bBox.color="yellow")}},i.inherits(e,n),e}),i("ig/geom/Circle",["require","../util","../DisplayObject","../collision"],function(t){"use strict";function e(){n.apply(this,arguments)}var i=t("../util"),n=t("../DisplayObject"),s=t("../collision"),r=Math.abs,a=Math.sqrt;return e.prototype={constructor:e,intersects:function(t,e){return s.checkCircleCircle(this,t,e)},intersectsPolygon:function(t,e){return s.checkCirclePolygon(this,t,e)},hitTestPoint:function(t,e){var i=r(t-this.x),n=r(e-this.y),s=a(i*i+n*n);return s<=this.radius?!0:!1},debugRender:function(t){this.debug&&(t.save(),t.strokeStyle="black",t.strokeRect(this.x-this.radius,this.y-this.radius,2*this.radius,2*this.radius),t.restore())}},i.inherits(e,n),e}),i("ig/geom/Vector",["require"],function(){function t(t,e){this.x=t||0,this.y=e||t||0}var e=Math.sqrt,i=Math.cos,n=Math.sin;return t.prototype={constructor:t,copy:function(t){return this.x=t.x,this.y=t.y,this},rotate:function(t){var e=this.x,s=this.y,r=i(t),a=n(t);return this.x=e*r-s*a,this.y=e*a+s*r,this},perp:function(){var t=this.x;return this.x=this.y,this.y=-t,this},reverse:function(){return this.x=-this.x,this.y=-this.y,this},normalize:function(){var t=this.len();return t>0&&(this.x/=t,this.y/=t),this},add:function(t){return this.x+=t.x,this.y+=t.y,this},sub:function(t){return this.x-=t.x,this.y-=t.y,this},scale:function(t,e){return this.x*=t,this.y*=e||t,this},project:function(t){var e=this.dot(t)/t.len2();return this.x=e*t.x,this.y=e*t.y,this},projectN:function(t){var e=this.dot(t);return this.x=e*t.x,this.y=e*t.y,this},reflect:function(t){var e=this.x,i=this.y;return this.project(t).scale(2),this.x-=e,this.y-=i,this},reflectN:function(t){var e=this.x,i=this.y;return this.projectN(t).scale(2),this.x-=e,this.y-=i,this},dot:function(t){return this.x*t.x+this.y*t.y},len2:function(){return this.dot(this)},len:function(){return e(this.len2())}},t}),i("ig/geom/Polygon",["require","../collision","./Vector"],function(t){"use strict";var e=t("../collision"),i=t("./Vector"),n={};return n.recalc=function(t){var e=t.points,n=e.length;t.edges=[],t.normals=[];for(var s=0;n>s;s++){var r=e[s],a=n-1>s?e[s+1]:e[0],o=(new i).copy(a).sub(r),h=(new i).copy(o).perp().normalize();t.edges.push(o),t.normals.push(h)}return t},n.toPolygon=function(t){var e=t.width,i=t.height;return t.points=[{x:0,y:0},{x:e,y:0},{x:e,y:i},{x:0,y:i}],n.recalc(t),t},n.getBounds=function(t){for(var e=t.points,i=t.x,n=t.y,e=t.points,i=t.x,n=t.y,s=Number.MAX_VALUE,r=Number.MIN_VALUE,a=Number.MAX_VALUE,o=Number.MIN_VALUE,h=0,c=e.length;c>h;h++)e[h].x<s&&(s=e[h].x),e[h].x>r&&(r=e[h].x),e[h].y<a&&(a=e[h].y),e[h].y>o&&(o=e[h].y);return t.bounds={x:s+i,y:a+n,width:r-s,height:o-a},t},n.intersects=function(t,i,n){return e.checkPolygonPolygon(t,i,n)},n.intersectsCircle=function(t,i,n){return e.checkPolygonCircle(t,i,n)},n}),i("ig/geom/Rect",["require","../util","../DisplayObject","../collision","./Polygon","./Vector"],function(t){"use strict";function e(){n.apply(this,arguments),this.toPolygon()}{var i=t("../util"),n=t("../DisplayObject"),s=t("../collision"),r=t("./Polygon");t("./Vector")}return e.prototype={constructor:e,toPolygon:function(){var t=this.width,e=this.height,i=new r({x:this.x,y:this.y,points:[{x:0,y:0},{x:t,y:0},{x:t,y:e},{x:0,y:e}]});return this.edges=i.edges,this.points=i.points,this.normals=i.normals,this},intersects:function(t,e){return s.checkPolygonPolygon(this,t,e)},hitTestPoint:function(t,e){return t>=this.x&&t<=this.x+this.width&&e>=this.y&&e<=this.y+this.height},getBounds:function(){return this.bounds={x:this.x,y:this.y,width:this.width,height:this.height},this},debugRender:function(t){this.debug&&(this.getBounds(),t.save(),t.strokeStyle="black",t.strokeRect(this.bounds.x,this.bounds.y,this.bounds.width,this.bounds.height),t.restore())}},i.inherits(e,n),e}),i("ig/collision",["require","./geom/Vector"],function(t){"use strict";function e(){this.first=null,this.second=null,this.overlapN=new r,this.overlapV=new r,this.reset()}function i(t,e,i){for(var n=Number.MAX_VALUE,s=-Number.MAX_VALUE,a=t.length;a--;){var o=new r(t[a].x,t[a].y).dot(e);n>o&&(n=o),o>s&&(s=o)}i[0]=n,i[1]=s}function n(t,e,n,s,r,a){var o=p.pop(),c=p.pop(),u=f.pop().copy(e).sub(t),l=u.dot(r);if(i(n,r,o),i(s,r,c),c[0]+=l,c[1]+=l,o[0]>c[1]||c[0]>o[1])return f.push(u),p.push(o),p.push(c),!0;if(a){var d=0;if(o[0]<c[0])if(a.firstInSecond=!1,o[1]<c[1])d=o[1]-c[0],a.secondInFirst=!1;else{var g=o[1]-c[0],v=c[1]-o[0];d=v>g?g:-v}else if(a.secondInFirst=!1,o[1]>c[1])d=o[0]-c[1],a.firstInSecond=!1;else{var g=o[1]-c[0],v=c[1]-o[0];d=v>g?g:-v}var m=h(d);m<a.overlap&&(a.overlap=m,a.overlapN.copy(r),0>d&&a.overlapN.reverse())}return f.push(u),p.push(o),p.push(c),!1}function s(t,e){var i=t.len2(),n=e.dot(t);return 0>n?c:n>i?l:u}for(var r=t("./geom/Vector"),a=Math.sqrt,o=Math.pow,h=Math.abs,c=-1,u=0,l=1,f=[],d=0;10>d;d++)f.push(new r);
for(var p=[],d=0;5>d;d++)p.push([]);e.prototype={constructor:e,reset:function(){return this.firstInSecond=!0,this.secondInFirst=!0,this.overlap=Number.MAX_VALUE,this}};var g=new e,v={};return v.checkCircleCircle=function(t,e,i){var n=f.pop().copy(new r(e.x,e.y)).sub(new r(t.x,t.y)),s=t.radius*t.scaleX+e.radius*e.scaleX,h=o(s,2),c=n.len2();if(c>h)return f.push(n),!1;if(i){g.reset();var u=a(c);return g.first=t,g.second=e,g.overlap=s-u,g.overlapN.copy(n.normalize()),g.overlapV.copy(n).scale(g.overlap),g.firstInSecond=t.radius<=e.radius&&u<=e.radius-t.radius,g.secondInFirst=e.radius<=t.radius&&u<=t.radius-e.radius,f.push(n),g}},v.checkPolygonPolygon=function(t,e,i){var s=t.points,r=s.length,a=e.points,o=a.length,h={x:t.x,y:t.y},c={x:e.x,y:e.y},u=null;for(i&&(u=g.reset());r--;)if(n(h,c,s,a,t.normals[r],u))return!1;for(;o--;)if(n(h,c,s,a,e.normals[o],u))return!1;return u&&(u.first=t,u.second=e,u.overlapV.copy(u.overlapN).scale(u.overlap)),u},v.checkPolygonCircle=function(t,e,i){var n=f.pop().copy(new r(e.x,e.y)).sub(new r(t.x,t.y)),a=e.radius,o=a*a,u=t.points,d=u.length,p=f.pop(),v=f.pop(),m=null;i&&(m=g.reset());for(var y=0;d>y;y++){var w=y===d-1?0:y+1,b=0===y?d-1:y-1,x=0,S=null;p.copy(t.edges[y]),v.copy(n).sub(u[y]),m&&v.len2()>o&&(m.firstInSecond=!1);var I=s(p,v);if(I===c){p.copy(t.edges[b]);var C=f.pop().copy(n).sub(u[b]);if(I=s(p,C),I===l){var O=v.len();if(O>a)return f.push(n),f.push(p),f.push(v),f.push(C),!1;m&&(m.secondInFirst=!1,S=v.normalize(),x=a-O)}f.push(C)}else if(I===l){if(p.copy(t.edges[w]),v.copy(n).sub(u[w]),I=s(p,v),I===c){var O=v.len();if(O>a)return f.push(n),f.push(p),f.push(v),!1;m&&(m.secondInFirst=!1,S=v.normalize(),x=a-O)}}else{var M=p.perp().normalize(),O=v.dot(M),P=h(O);if(O>0&&P>a)return f.push(n),f.push(M),f.push(v),!1;m&&(S=M,x=a-O,(O>=0||2*a>x)&&(m.secondInFirst=!1))}S&&m&&h(x)<h(m.overlap)&&(m.overlap=x,m.overlapN.copy(S))}return m&&(m.a=t,m.b=e,m.overlapV.copy(m.overlapN).scale(m.overlap)),f.push(n),f.push(p),f.push(v),m},v.checkCirclePolygon=function(t,e,i){var n=v.checkPolygonCircle(e,t,i);if(n){var s=n.first,r=n.firstInSecond;n.overlapN.reverse(),n.overlapV.reverse(),n.first=n.second,n.second=s,n.firstInSecond=n.secondInFirst,n.secondInFirst=r}return n},v.checkPointPolygon=function(t,e){for(var i=e.points,n=i.length,s=!1,r=0,a=n-1;n>r;a=r,r++){var o=i[r].x+e.x,h=i[r].y+e.y,c=i[a].x+e.x,u=i[a].y+e.y;if(o===t.x&&h===t.y||c===t.x&&u===t.y)return!0;if(h<t.y&&u>=t.y||h>=t.y&&u<t.y){var l=o+(t.y-h)*(c-o)/(u-h);if(l===t.x)return!0;l>t.x&&(s=!s)}}return s},v}),i("ig/geom/polygon",["require","../collision","./Vector"],function(t){"use strict";var e=t("../collision"),i=t("./Vector"),n={};return n.recalc=function(t){var e=t.points,n=e.length;t.edges=[],t.normals=[];for(var s=0;n>s;s++){var r=e[s],a=n-1>s?e[s+1]:e[0],o=(new i).copy(a).sub(r),h=(new i).copy(o).perp().normalize();t.edges.push(o),t.normals.push(h)}return t},n.toPolygon=function(t){var e=t.width,i=t.height;return t.points=[{x:0,y:0},{x:e,y:0},{x:e,y:i},{x:0,y:i}],n.recalc(t),t},n.getBounds=function(t){for(var e=t.points,i=t.x,n=t.y,e=t.points,i=t.x,n=t.y,s=Number.MAX_VALUE,r=Number.MIN_VALUE,a=Number.MAX_VALUE,o=Number.MIN_VALUE,h=0,c=e.length;c>h;h++)e[h].x<s&&(s=e[h].x),e[h].x>r&&(r=e[h].x),e[h].y<a&&(a=e[h].y),e[h].y>o&&(o=e[h].y);return t.bounds={x:s+i,y:a+n,width:r-s,height:o-a},t},n.intersects=function(t,i,n){return e.checkPolygonPolygon(t,i,n)},n.intersectsCircle=function(t,i,n){return e.checkPolygonCircle(t,i,n)},n}),i("ig/domEvt",["require","./util","./env","./Event"],function(t){"use strict";function e(t){for(var e=0,i=a.length;i>e;e++)if(a[e].name===t)return!0;return!1}var i=t("./util"),n=t("./env"),s=(t("./Event"),["touchstart","touchmove","touchend"]),r=["mousedown","mousemove","mouseup"],a=[],o={};return o.events=n.supportTouch?s:r,o.fireEvt={},o.fireEvt.touchstart=o.fireEvt.mousedown=function(t){for(var e=t.target,i=e.displayObjectList,n=0,s=i.length;s>n;n++){var r=i[n];r.mouseEnable&&r.hitTestPoint(t.data.x,t.data.y)&&(t.data.curStage=e,r.isCapture=!0,r.captureFunc.call(r,t.data))}return e},o.fireEvt.touchmove=o.fireEvt.mousemove=function(t){for(var i=t.target,n=i.displayObjectList,s=0,r=n.length;r>s;s++){var o=n[s];o.hitTestPoint(t.data.x,t.data.y)&&!e(o.name)&&a.push(o),t.data.holdSprites=a,o.mouseEnable&&o.isCapture&&(t.data.curStage=i,o.moveFunc.call(o,t.data))}return i},o.fireEvt.touchend=o.fireEvt.mouseup=function(t){for(var i=t.target,n=i.displayObjectList,s=0,r=n.length;r>s;s++){var o=n[s];(o.isCapture||e(o.name))&&(o.releaseFunc.call(o,t.data),o.isCapture=!1)}return a=[],i},o.initMouse=function(t){this.stage=t,this.element=t.canvas,this.x=0,this.y=0,this.isDown=!1;var e=i.getElementOffset(this.element);return this.offsetX=e.x,this.offsetY=e.y,this.addEvent(),this},o.refreshMouse=function(t){console.warn("refreshMouse"),this.stage=t,this.element=t.canvas,this.x=0,this.y=0,this.isDown=!1;var e=i.getElementOffset(this.element);return this.offsetX=e.x,this.offsetY=e.y,this},o.addEvent=function(){var t=this,e=t.element;t.events.forEach(function(i,n){e.addEventListener(i,function(e){e.preventDefault(),0==n?t.isDown=!0:2==n&&(t.isDown=!1);var s=e.changedTouches?e.changedTouches[0].pageX:e.pageX,r=e.changedTouches?e.changedTouches[0].pageY:e.pageY;t.x=s-t.offsetX,t.y=r-t.offsetY,t.stage.fire(i,{data:{x:t.x,y:t.y,isDown:t.isDown}})})})},o}),i("ig/Bitmap",["require","./util","./DisplayObject","./geom/polygon"],function(t){"use strict";function e(t){if(t=t||{},!t.image)throw new Error("Bitmap must be require a image param");n.apply(this,arguments),this.sX=t.sX||0,this.sY=t.sY||0,this.sWidth=t.sWidth||0,this.sHeight=t.sHeight||0,this.width=t.width||this.image.width||0,this.height=t.height||this.image.height||0,t.points&&t.points.length&&"array"===i.getType(t.points)?this.points=t.points:s.toPolygon(this),s.recalc(this),s.getBounds(this)}var i=t("./util"),n=t("./DisplayObject"),s=t("./geom/polygon");return e.prototype={constructor:e,setSY:function(t){this.sY=t},render:function(t){return s.getBounds(this),t.save(),t.globalAlpha=this.alpha,t.translate(this.x,this.y),t.rotate(i.deg2Rad(this.angle)),t.scale(this.scaleX,this.scaleY),t.translate(-this.x,-this.y),t.drawImage(this.image,this.sX,this.sY,this.sWidth||this.width,this.sHeight||this.height,this.x,this.y,this.width,this.height),this.debugRender(t),t.restore(),this},hitTestPoint:function(t,e){return t>=this.bounds.x&&t<=this.bounds.x+this.bounds.width&&e>=this.bounds.y&&e<=this.bounds.y+this.bounds.height},debugRender:function(t){this.debug&&(t.save(),t.strokeStyle="black",t.strokeRect(this.bounds.x,this.bounds.y,this.bounds.width,this.bounds.height),t.restore())}},i.inherits(e,n),e}),i("ig/Text",["require","./util","./DisplayObject","./geom/polygon"],function(t){"use strict";function e(t){t=t||{},n.apply(this,arguments),i.extend(this,{content:"0",color:this.fillStyle,size:30,holdTime:0,animate:i.extend({},{duration:1e3},t.animate)},t),console.warn(this)}{var i=t("./util"),n=t("./DisplayObject");t("./geom/polygon")}return e.prototype={constructor:e,changeContent:function(t){return this.content=t,this},getContent:function(){return this.content},render:function(t){t.save(),t.fillStyle=this.color,t.globalAlpha=this.alpha,t.translate(this.x,this.y),t.rotate(i.deg2Rad(this.angle)),t.scale(this.scaleX,this.scaleY),t.translate(-this.x,-this.y),t.font="bold "+this.size+"px sans-serif";var e=this.content,n=t.measureText(e).width;return t.fillText(this.content,this.x-.5*n,this.y),t.restore(),this}},i.inherits(e,n),e}),i("ig/easing",["require"],function(){"use strict";var t={};return t.linear=function(t,e,i,n){return i*t/n+e},t.easeInQuad=function(t,e,i,n){return i*(t/=n)*t+e},t.easeOutQuad=function(t,e,i,n){return-i*(t/=n)*(t-2)+e},t.easeInOutQuad=function(t,e,i,n){return(t/=n/2)<1?i/2*t*t+e:-i/2*(--t*(t-2)-1)+e},t.easeInCubic=function(t,e,i,n){return i*(t/=n)*t*t+e},t.easeOutCubic=function(t,e,i,n){return i*((t=t/n-1)*t*t+1)+e},t.easeInOutCubic=function(t,e,i,n){return(t/=n/2)<1?i/2*t*t*t+e:i/2*((t-=2)*t*t+2)+e},t.easeInQuart=function(t,e,i,n){return i*(t/=n)*t*t*t+e},t.easeOutQuart=function(t,e,i,n){return-i*((t=t/n-1)*t*t*t-1)+e},t.easeInOutQuart=function(t,e,i,n){return(t/=n/2)<1?i/2*t*t*t*t+e:-i/2*((t-=2)*t*t*t-2)+e},t.easeInQuint=function(t,e,i,n){return i*(t/=n)*t*t*t*t+e},t.easeOutQuint=function(t,e,i,n){return i*((t=t/n-1)*t*t*t*t+1)+e},t.easeInOutQuint=function(t,e,i,n){return(t/=n/2)<1?i/2*t*t*t*t*t+e:i/2*((t-=2)*t*t*t*t+2)+e},t.easeInSine=function(t,e,i,n){return-i*Math.cos(t/n*(Math.PI/2))+i+e},t.easeOutSine=function(t,e,i,n){return i*Math.sin(t/n*(Math.PI/2))+e},t.easeInOutSine=function(t,e,i,n){return-i/2*(Math.cos(Math.PI*t/n)-1)+e},t.easeInExpo=function(t,e,i,n){return 0===t?e:i*Math.pow(2,10*(t/n-1))+e},t.easeOutExpo=function(t,e,i,n){return t==n?e+i:i*(-Math.pow(2,-10*t/n)+1)+e},t.easeInOutExpo=function(t,e,i,n){return 0===t?e:t==n?e+i:(t/=n/2)<1?i/2*Math.pow(2,10*(t-1))+e:i/2*(-Math.pow(2,-10*--t)+2)+e},t.easeInCirc=function(t,e,i,n){return-i*(Math.sqrt(1-(t/=n)*t)-1)+e},t.easeOutCirc=function(t,e,i,n){return i*Math.sqrt(1-(t=t/n-1)*t)+e},t.easeInOutCirc=function(t,e,i,n){return(t/=n/2)<1?-i/2*(Math.sqrt(1-t*t)-1)+e:i/2*(Math.sqrt(1-(t-=2)*t)+1)+e},t.easeInElastic=function(t,e,i,n,s,r){if(0===t)return e;if(1==(t/=n))return e+i;r||(r=.3*n);var a;return!s||s<Math.abs(i)?(s=i,a=r/4):a=r/(2*Math.PI)*Math.asin(i/s),-(s*Math.pow(2,10*(t-=1))*Math.sin(2*(t*n-a)*Math.PI/r))+e},t.easeOutElastic=function(t,e,i,n,s,r){if(0===t)return e;if(1==(t/=n))return e+i;r||(r=.3*n);var a;return!s||s<Math.abs(i)?(s=i,a=r/4):a=r/(2*Math.PI)*Math.asin(i/s),s*Math.pow(2,-10*t)*Math.sin(2*(t*n-a)*Math.PI/r)+i+e},t.easeInOutElastic=function(t,e,i,n,s,r){if(0===t)return e;if(2==(t/=n/2))return e+i;r||(r=.3*n*1.5);var a;return!s||s<Math.abs(i)?(s=i,a=r/4):a=r/(2*Math.PI)*Math.asin(i/s),1>t?-.5*s*Math.pow(2,10*(t-=1))*Math.sin(2*(t*n-a)*Math.PI/r)+e:s*Math.pow(2,-10*(t-=1))*Math.sin(2*(t*n-a)*Math.PI/r)*.5+i+e},t.easeInBack=function(t,e,i,n,s){return void 0===s&&(s=1.70158),i*(t/=n)*t*((s+1)*t-s)+e},t.easeOutBack=function(t,e,i,n,s){return void 0===s&&(s=1.70158),i*((t=t/n-1)*t*((s+1)*t+s)+1)+e},t.easeInOutBack=function(t,e,i,n,s){return void 0===s&&(s=1.70158),(t/=n/2)<1?i/2*t*t*(((s*=1.525)+1)*t-s)+e:i/2*((t-=2)*t*(((s*=1.525)+1)*t+s)+2)+e},t.easeInBounce=function(e,i,n,s){return n-t.easeOutBounce(s-e,0,n,s)+i},t.easeOutBounce=function(t,e,i,n){return(t/=n)<1/2.75?7.5625*i*t*t+e:2/2.75>t?i*(7.5625*(t-=1.5/2.75)*t+.75)+e:2.5/2.75>t?i*(7.5625*(t-=2.25/2.75)*t+.9375)+e:i*(7.5625*(t-=2.625/2.75)*t+.984375)+e},t.easeInOutBounce=function(e,i,n,s){return s/2>e?.5*t.easeInBounce(2*e,0,n,s)+i:.5*t.easeOutBounce(2*e-s,0,n,s)+.5*n+i},t}),i("ig/Animation",["require","./util","./Event","./easing"],function(t){"use strict";function e(t){t=t||{},n.apply(this,arguments),i.extend(this,{source:{},target:{},range:null,tween:s.linear,repeat:!1,duration:1e3,fps:r},t),this.setup(),this._={_repeatCount:0,_then:Date.now(),_interval:1e3/this.fps}}var i=t("./util"),n=t("./Event"),s=t("./easing"),r=60;return e.prototype={constructor:e,setup:function(){this.running=!1,this.curFrame=0,this.initState={},this.frames=Math.ceil(this.duration*this.fps/1e3);var t=this.source,e=this.target,i=this.range;if(i)for(var n in i)this.initState[n]={from:parseFloat(t[n]-i[n]),to:parseFloat(t[n]+i[n])};else for(var n in e)this.initState[n]={from:parseFloat(t[n]),to:parseFloat(e[n])};return this},swapFromTo:function(){var t={};for(var e in this.initState)t[e]={from:this.initState[e].to,to:this.initState[e].from};return this.curFrame=0,this.initState=t,this},repeatFunc:function(){return this._._repeatCount++,this.swapFromTo(),this.fire("repeat",{data:{source:this.source,instance:this,repeatCount:this._._repeatCount}}),this.play(),this},play:function(){return this.running=!0,this.timer&&this.stop(),this.step(),this},stop:function(){return window.cancelAnimationFrame(this.timer),this},next:function(){return this.stop(),this.curFrame++,this.curFrame=this.curFrame>this.frames?this.frames:this.curFrame,this.step.call(this),this},prev:function(){return this.stop(),this.curFrame--,this.curFrame=this.curFrame<0?0:this.curFrame,this.step.call(this),this},gotoAndPlay:function(t){return this.stop(),this.curFrame=t,this.play.call(this),this},gotoAndStop:function(t){return this.stop(),this.curFrame=t,this.step.call(this),this},step:function(){var t=this;if(t.timer=window.requestAnimationFrame(function(){return function(){t.step.call(t)}}(t)),t._._now=Date.now(),t._._delta=t._._now-t._._then,t._._delta>t._._interval){t._._then=t._._now-t._._delta%t._._interval;var e;for(var i in t.initState)e=t.tween(t.curFrame,t.initState[i].from,t.initState[i].to-t.initState[i].from,t.frames).toFixed(2),t.source[i]=parseFloat(e);if(t.curFrame++,this.curFrame>=this.frames)return void(t.repeat?t.repeatFunc.call(t):t.range&&!t.rangeExec?(t.rangeExec=!0,t.swapFromTo()):(t.stop(),t.running=!1,t.fire("complete",{data:{source:t.source,instance:t}})))}}},i.inherits(e,n),e});var n,s=e("ig"),r="ig/util",a="util",o="";o?s[o]?s[o][a]=e(r):(n={},n[a]=e(r),s[o]=n):(n=e(r),a&&(s[a]=n));var n,r="ig/Event",a="Event",o="";o?s[o]?s[o][a]=e(r):(n={},n[a]=e(r),s[o]=n):(n=e(r),a&&(s[a]=n));var n,r="ig/env",a="env",o="";o?s[o]?s[o][a]=e(r):(n={},n[a]=e(r),s[o]=n):(n=e(r),a&&(s[a]=n));var n,r="ig/Game",a="Game",o="";o?s[o]?s[o][a]=e(r):(n={},n[a]=e(r),s[o]=n):(n=e(r),a&&(s[a]=n));var n,r="ig/Stage",a="",o="";o?s[o]?s[o][a]=e(r):(n={},n[a]=e(r),s[o]=n):(n=e(r),a&&(s[a]=n));var n,r="ig/DisplayObject",a="DisplayObject",o="";o?s[o]?s[o][a]=e(r):(n={},n[a]=e(r),s[o]=n):(n=e(r),a&&(s[a]=n));var n,r="ig/SpriteSheet",a="SpriteSheet",o="";o?s[o]?s[o][a]=e(r):(n={},n[a]=e(r),s[o]=n):(n=e(r),a&&(s[a]=n));var n,r="ig/resourceLoader",a="",o="";o?s[o]?s[o][a]=e(r):(n={},n[a]=e(r),s[o]=n):(n=e(r),a&&(s[a]=n));var n,r="ig/Stage",a="",o="";o?s[o]?s[o][a]=e(r):(n={},n[a]=e(r),s[o]=n):(n=e(r),a&&(s[a]=n));var n,r="ig/Shape/Ball",a="Ball",o="Shape";o?s[o]?s[o][a]=e(r):(n={},n[a]=e(r),s[o]=n):(n=e(r),a&&(s[a]=n));var n,r="ig/geom/Circle",a="Circle",o="geom";o?s[o]?s[o][a]=e(r):(n={},n[a]=e(r),s[o]=n):(n=e(r),a&&(s[a]=n));var n,r="ig/geom/Vector",a="Vector",o="geom";o?s[o]?s[o][a]=e(r):(n={},n[a]=e(r),s[o]=n):(n=e(r),a&&(s[a]=n));var n,r="ig/geom/Polygon",a="Polygon",o="geom";o?s[o]?s[o][a]=e(r):(n={},n[a]=e(r),s[o]=n):(n=e(r),a&&(s[a]=n));var n,r="ig/geom/Rect",a="Rect",o="geom";o?s[o]?s[o][a]=e(r):(n={},n[a]=e(r),s[o]=n):(n=e(r),a&&(s[a]=n));var n,r="ig/collision",a="",o="";o?s[o]?s[o][a]=e(r):(n={},n[a]=e(r),s[o]=n):(n=e(r),a&&(s[a]=n));var n,r="ig/geom/polygon",a="",o="geom";o?s[o]?s[o][a]=e(r):(n={},n[a]=e(r),s[o]=n):(n=e(r),a&&(s[a]=n));var n,r="ig/domEvt",a="",o="";o?s[o]?s[o][a]=e(r):(n={},n[a]=e(r),s[o]=n):(n=e(r),a&&(s[a]=n));var n,r="ig/Bitmap",a="Bitmap",o="";o?s[o]?s[o][a]=e(r):(n={},n[a]=e(r),s[o]=n):(n=e(r),a&&(s[a]=n));var n,r="ig/Text",a="Text",o="";o?s[o]?s[o][a]=e(r):(n={},n[a]=e(r),s[o]=n):(n=e(r),a&&(s[a]=n));var n,r="ig/easing",a="easing",o="";o?s[o]?s[o][a]=e(r):(n={},n[a]=e(r),s[o]=n):(n=e(r),a&&(s[a]=n));var n,r="ig/Animation",a="Animation",o="";o?s[o]?s[o][a]=e(r):(n={},n[a]=e(r),s[o]=n):(n=e(r),a&&(s[a]=n)),t.ig=s}(window);