!function(t){var e,i;!function(){function t(t,e){if(!e)return t;if(0===t.indexOf(".")){var i=e.split("/"),n=t.split("/"),s=i.length-1,r=n.length,a=0,o=0;t:for(var h=0;r>h;h++)switch(n[h]){case"..":if(!(s>a))break t;a++,o++;break;case".":o++;break;default:break t}return i.length=s-a,n=n.slice(o),i.concat(n).join("/")}return t}function n(e){function i(i,a){if("string"==typeof i){var o=n[i];return o||(o=r(t(i,e)),n[i]=o),o}i instanceof Array&&(a=a||function(){},a.apply(this,s(i,a,e)))}var n={};return i}function s(i,n,s){for(var o=[],h=a[s],u=0,c=Math.min(i.length,n.length);c>u;u++){var l,m=t(i[u],s);switch(m){case"require":l=h&&h.require||e;break;case"exports":l=h.exports;break;case"module":l=h;break;default:l=r(m)}o.push(l)}return o}function r(t){var e=a[t];if(!e)throw new Error("No "+t);if(!e.defined){var i=e.factory,n=i.apply(this,s(e.deps||[],i,t));"undefined"!=typeof n&&(e.exports=n),e.defined=1}return e.exports}var a={};i=function(t,e,i){a[t]={id:t,deps:e,factory:i,defined:0,exports:{},require:n(t)}},e=n("")}(),i("ig",["ig/ig"],function(t){return t}),i("ig/ig",["require","./util"],function(t){window.requestAnimationFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame||window.oRequestAnimationFrame||function(t){var e,i,n=this;setTimeout(function(){e=+new Date,t(e),i=+new Date,n.timeout=1e3/60-(i-e)},n.timeout)}}(),window.cancelAnimationFrame=function(){return window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.webkitCancelRequestAnimationFrame||window.mozCancelAnimationFrame||window.mozCancelRequestAnimationFrame||window.msCancelAnimationFrame||window.msCancelRequestAnimationFrame||window.oCancelAnimationFrame||window.oCancelRequestAnimationFrame||window.clearTimeout}();var e=t("./util"),i={};return i.STATUS={NORMAL:1,NOT_RENDER:2,NOT_UPDATE:3,NOT_RU:4,DESTROYED:5},i.loop=function(t){var i,n,s,r=e.extend(!0,{},{fps:60,exec:e.noop,ticksPerFrame:0},t),a=Date.now(),o=1e3/r.fps,h=0;!function u(){i=window.requestAnimationFrame(u),n=Date.now(),s=n-a,s>o&&(a=n-s%o,h++,h>r.ticksPerFrame&&(h=0,r.exec(i)))}()},i}),i("ig/util",["require"],function(){var t=Math.PI/180,e=180/Math.PI,i=Object.prototype,n={};return n.noop=function(){},n.getType=function(t){var e=i.toString.call(t).slice(8,-1);return e.toLowerCase()},n.isType=function(t,e){var i=n.getType(e);return t.toLowerCase()===i},n.isWindow=function(t){return null!=t&&t===t.window},n.isPlainObject=function(t){return"object"!==n.getType(t)||t.nodeType||n.isWindow(t)?!1:t.constructor&&!{}.hasOwnProperty.call(t.constructor.prototype,"isPrototypeOf")?!1:!0},n.extend=function(){var t,e,i,s,r,a,o=arguments[0]||{},h=1,u=arguments.length,c=!1;for("boolean"==typeof o&&(c=o,o=arguments[h]||{},h++),"object"==typeof o||n.isType("function",o)||(o={}),h===u&&(o=this,h--);u>h;h++)if(null!=(t=arguments[h]))for(e in t)if(t.hasOwnProperty(e)){if(i=o[e],s=t[e],o===s)continue;c&&s&&(n.isPlainObject(s)||(r=Array.isArray(s)))?(r?(r=!1,a=i&&Array.isArray(i)?i:[]):a=i&&n.isPlainObject(i)?i:{},o[e]=n.extend(c,a,s)):void 0!==s&&(o[e]=s)}return o},n.inherits=function(t,e){var i=function(){};i.prototype=e.prototype;var n=t.prototype,s=t.prototype=new i;for(var r in n)n.hasOwnProperty(r)&&(s[r]=n[r]);return t.prototype.constructor=t,t.superClass=e.prototype,t},n.deg2Rad=function(e){return e*t},n.rad2Deg=function(t){return t*e},n.randomInt=function(t,e){return Math.floor(Math.random()*(e-t+1)+t)},n.randomFloat=function(t,e){return Math.random()*(e-t)+t},n.removeArrByCondition=function(t,e){for(var i,n=-1,s=0,r=t.length;r>s;s++)if(i=t[s],e(i)){n=s;break}-1!==n&&t.splice(n,1)},n.window2Canvas=function(t,e,i){var n=t.getBoundingClientRect();return{x:Math.round(e-n.left*(t.width/n.width)),y:Math.round(i-n.top*(t.height/n.height))}},n.domWrap=function(t,e,i){return t.parentNode.insertBefore(e,t),e.appendChild(t),e.id=i||"ig-create-dom-"+Date.now(),t},n.getElementOffset=function(t){for(var e=t.offsetLeft,i=t.offsetTop;(t=t.offsetParent)&&t!=document.body&&t!=document;)e+=t.offsetLeft,i+=t.offsetTop;return{x:e,y:i}},n}),i("ig/easing",["require"],function(){var t={};return t.linear=function(t,e,i,n){return i*t/n+e},t.easeInQuad=function(t,e,i,n){return i*(t/=n)*t+e},t.easeOutQuad=function(t,e,i,n){return-i*(t/=n)*(t-2)+e},t.easeInOutQuad=function(t,e,i,n){return(t/=n/2)<1?i/2*t*t+e:-i/2*(--t*(t-2)-1)+e},t.easeInCubic=function(t,e,i,n){return i*(t/=n)*t*t+e},t.easeOutCubic=function(t,e,i,n){return i*((t=t/n-1)*t*t+1)+e},t.easeInOutCubic=function(t,e,i,n){return(t/=n/2)<1?i/2*t*t*t+e:i/2*((t-=2)*t*t+2)+e},t.easeInQuart=function(t,e,i,n){return i*(t/=n)*t*t*t+e},t.easeOutQuart=function(t,e,i,n){return-i*((t=t/n-1)*t*t*t-1)+e},t.easeInOutQuart=function(t,e,i,n){return(t/=n/2)<1?i/2*t*t*t*t+e:-i/2*((t-=2)*t*t*t-2)+e},t.easeInQuint=function(t,e,i,n){return i*(t/=n)*t*t*t*t+e},t.easeOutQuint=function(t,e,i,n){return i*((t=t/n-1)*t*t*t*t+1)+e},t.easeInOutQuint=function(t,e,i,n){return(t/=n/2)<1?i/2*t*t*t*t*t+e:i/2*((t-=2)*t*t*t*t+2)+e},t.easeInSine=function(t,e,i,n){return-i*Math.cos(t/n*(Math.PI/2))+i+e},t.easeOutSine=function(t,e,i,n){return i*Math.sin(t/n*(Math.PI/2))+e},t.easeInOutSine=function(t,e,i,n){return-i/2*(Math.cos(Math.PI*t/n)-1)+e},t.easeInExpo=function(t,e,i,n){return 0===t?e:i*Math.pow(2,10*(t/n-1))+e},t.easeOutExpo=function(t,e,i,n){return t===n?e+i:i*(-Math.pow(2,-10*t/n)+1)+e},t.easeInOutExpo=function(t,e,i,n){return 0===t?e:t===n?e+i:(t/=n/2)<1?i/2*Math.pow(2,10*(t-1))+e:i/2*(-Math.pow(2,-10*--t)+2)+e},t.easeInCirc=function(t,e,i,n){return-i*(Math.sqrt(1-(t/=n)*t)-1)+e},t.easeOutCirc=function(t,e,i,n){return i*Math.sqrt(1-(t=t/n-1)*t)+e},t.easeInOutCirc=function(t,e,i,n){return(t/=n/2)<1?-i/2*(Math.sqrt(1-t*t)-1)+e:i/2*(Math.sqrt(1-(t-=2)*t)+1)+e},t.easeInElastic=function(t,e,i,n,s,r){if(0===t)return e;if(1===(t/=n))return e+i;r||(r=.3*n);var a;return!s||s<Math.abs(i)?(s=i,a=r/4):a=r/(2*Math.PI)*Math.asin(i/s),-(s*Math.pow(2,10*(t-=1))*Math.sin(2*(t*n-a)*Math.PI/r))+e},t.easeOutElastic=function(t,e,i,n,s,r){if(0===t)return e;if(1===(t/=n))return e+i;r||(r=.3*n);var a;return!s||s<Math.abs(i)?(s=i,a=r/4):a=r/(2*Math.PI)*Math.asin(i/s),s*Math.pow(2,-10*t)*Math.sin(2*(t*n-a)*Math.PI/r)+i+e},t.easeInOutElastic=function(t,e,i,n,s,r){if(0===t)return e;if(2===(t/=n/2))return e+i;r||(r=.3*n*1.5);var a;return!s||s<Math.abs(i)?(s=i,a=r/4):a=r/(2*Math.PI)*Math.asin(i/s),1>t?-.5*s*Math.pow(2,10*(t-=1))*Math.sin(2*(t*n-a)*Math.PI/r)+e:s*Math.pow(2,-10*(t-=1))*Math.sin(2*(t*n-a)*Math.PI/r)*.5+i+e},t.easeInBack=function(t,e,i,n,s){return void 0===s&&(s=1.70158),i*(t/=n)*t*((s+1)*t-s)+e},t.easeOutBack=function(t,e,i,n,s){return void 0===s&&(s=1.70158),i*((t=t/n-1)*t*((s+1)*t+s)+1)+e},t.easeInOutBack=function(t,e,i,n,s){return void 0===s&&(s=1.70158),(t/=n/2)<1?i/2*t*t*(((s*=1.525)+1)*t-s)+e:i/2*((t-=2)*t*(((s*=1.525)+1)*t+s)+2)+e},t.easeInBounce=function(e,i,n,s){return n-t.easeOutBounce(s-e,0,n,s)+i},t.easeOutBounce=function(t,e,i,n){return(t/=n)<1/2.75?7.5625*i*t*t+e:2/2.75>t?i*(7.5625*(t-=1.5/2.75)*t+.75)+e:2.5/2.75>t?i*(7.5625*(t-=2.25/2.75)*t+.9375)+e:i*(7.5625*(t-=2.625/2.75)*t+.984375)+e},t.easeInOutBounce=function(e,i,n,s){return s/2>e?.5*t.easeInBounce(2*e,0,n,s)+i:.5*t.easeOutBounce(2*e-s,0,n,s)+.5*n+i},t}),i("ig/env",["require"],function(){function t(t){var e={},i={},n=t.match(/Web[kK]it[\/]{0,1}([\d.]+)/),s=t.match(/(Android);?[\s\/]+([\d.]+)?/),r=!!t.match(/\(Macintosh\; Intel /),a=t.match(/(iPad).*OS\s([\d_]+)/),o=t.match(/(iPod)(.*OS\s([\d_]+))?/),h=!a&&t.match(/(iPhone\sOS)\s([\d_]+)/),u=t.match(/(webOS|hpwOS)[\s\/]([\d.]+)/),c=t.match(/Windows Phone ([\d.]+)/),l=u&&t.match(/TouchPad/),m=t.match(/Kindle\/([\d.]+)/),f=t.match(/Silk\/([\d._]+)/),d=t.match(/(BlackBerry).*Version\/([\d.]+)/),p=t.match(/(BB10).*Version\/([\d.]+)/),g=t.match(/(RIM\sTablet\sOS)\s([\d.]+)/),v=t.match(/PlayBook/),y=t.match(/Chrome\/([\d.]+)/)||t.match(/CriOS\/([\d.]+)/),w=t.match(/Firefox\/([\d.]+)/),x=t.match(/MSIE\s([\d.]+)/)||t.match(/Trident\/[\d](?=[^\?]+).*rv:([0-9.].)/),b=!y&&t.match(/(iPhone|iPod|iPad).*AppleWebKit(?!.*Safari)/),S=b||t.match(/Version\/([\d.]+)([^S](Safari)|[^M]*(Mobile)[^S]*(Safari))/),O=t.match(/MicroMessenger\/([\d.]+)/),F=t.match(/baiduboxapp\/[^\/]+\/([\d.]+)_/)||t.match(/baiduboxapp\/([\d.]+)/)||t.match(/BaiduHD\/([\d.]+)/)||t.match(/FlyFlow\/([\d.]+)/)||t.match(/baidubrowser\/([\d.]+)/),P=t.match(/MQQBrowser\/([\d.]+)/)||t.match(/QQ\/([\d.]+)/),C=t.match(/UCBrowser\/([\d.]+)/),M=t.match(/SogouMobileBrowser\/([\d.]+)/),A=s&&t.match(/MiuiBrowser\/([\d.]+)/),I=t.match(/LBKIT/),T=t.match(/Mercury\/([\d.]+)/);return(i.webkit=!!n)&&(i.version=n[1]),s&&(e.android=!0,e.version=s[2]),h&&!o&&(e.ios=e.iphone=!0,e.version=h[2].replace(/_/g,".")),a&&(e.ios=e.ipad=!0,e.version=a[2].replace(/_/g,".")),o&&(e.ios=e.ipod=!0,e.version=o[3]?o[3].replace(/_/g,"."):null),c&&(e.wp=!0,e.version=c[1]),u&&(e.webos=!0,e.version=u[2]),l&&(e.touchpad=!0),d&&(e.blackberry=!0,e.version=d[2]),p&&(e.bb10=!0,e.version=p[2]),g&&(e.rimtabletos=!0,e.version=g[2]),v&&(i.playbook=!0),m&&(e.kindle=!0,e.version=m[1]),f&&(i.silk=!0,i.version=f[1]),!f&&e.android&&t.match(/Kindle Fire/)&&(i.silk=!0),y&&(i.chrome=!0,i.version=y[1]),w&&(i.firefox=!0,i.version=w[1]),x&&(i.ie=!0,i.version=x[1]),S&&(r||e.ios)&&(i.safari=!0,r&&(i.version=S[1])),b&&(i.webview=!0),O&&(i.wechat=!0,i.version=O[1]),F&&(delete i.webview,i.baidu=!0,i.version=F[1]),P&&(i.qq=!0,i.version=P[1]),C&&(delete i.webview,i.uc=!0,i.version=C[1]),M&&(delete i.webview,i.sogou=!0,i.version=M[1]),A&&(i.xiaomi=!0,i.version=A[1]),I&&(i.liebao=!0,i.version="0"),T&&(i.mercury=!0,i.version=T[1]),navigator.standalone&&(i.standalone=!0),e.tablet=!!(a||v||s&&!t.match(/Mobile/)||w&&t.match(/Tablet/)||x&&!t.match(/Phone/)&&t.match(/Touch/)),e.phone=!(e.tablet||e.ipod||!(s||h||u||d||p||y&&t.match(/Android/)||y&&t.match(/CriOS\/([\d.]+)/)||w&&t.match(/Mobile/)||x&&t.match(/Touch/))),{browser:i,os:e}}function e(t){t.audioData=!!window.Audio,t.webAudio=!(!window.AudioContext&&!window.webkitAudioContext);var e=document.createElement("audio"),i=!1;try{(i=!!e.canPlayType)&&(e.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,"")&&(t.ogg=!0),(e.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,"")||e.canPlayType("audio/opus;").replace(/^no$/,""))&&(t.opus=!0),e.canPlayType("audio/mpeg;").replace(/^no$/,"")&&(t.mp3=!0),e.canPlayType('audio/wav; codecs="1"').replace(/^no$/,"")&&(t.wav=!0),(e.canPlayType("audio/x-m4a;")||e.canPlayType("audio/aac;").replace(/^no$/,""))&&(t.m4a=!0),e.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")&&(t.webm=!0))}catch(n){}}var i=t(navigator.userAgent),n={browser:i.browser,os:i.os,supportOrientation:"number"==typeof window.orientation&&"object"==typeof window.onorientationchange,supportTouch:"ontouchstart"in window||window.DocumentTouch&&document instanceof window.DocumentTouch,supportGeolocation:null!=navigator.geolocation,isAndroid:i.os.android,isIOS:i.os.ios,isPhone:i.os.phone,isTablet:i.os.tablet,isMobile:i.os.phone||i.os.tablet};return e(n),n}),i("ig/resourceLoader",["require","./ig","./util"],function(t){function e(t){var e=t.split(".");return e[e.length-1].toLowerCase()}var i=t("./ig"),n=t("./util"),s={png:"Image",jpg:"Image",gif:"Image",jpeg:"Image",ogg:"Audio",wav:"Audio",m4a:"Audio",mp3:"Audio"},r={};return i.resources=r.resources={},i.loadOther=r.loadOther=function(){var t,i,s,r,a=arguments.length;switch(a){case 1:t=i=arguments[0],s=r=n.noop;break;case 2:t=i=arguments[0],s=r=arguments[1];break;case 3:t=i=arguments[0],s=arguments[1],r=arguments[2];break;default:t=arguments[0],i=arguments[1],s=arguments[2],r=arguments[3]}var o=e(i),h=new XMLHttpRequest;h.onreadystatechange=function(){4===h.readyState&&(200===h.status?"json"===o?s(t,JSON.parse(h.responseText)):s(t,h.responseText):r(i))},h.open("GET",i,!0),h.send(null)},i.loadImage=r.loadImage=function(){var t,e,i,s,r=arguments.length;switch(r){case 1:t=e=arguments[0],i=s=n.noop;break;case 2:t=e=arguments[0],i=s=arguments[1];break;case 3:t=e=arguments[0],i=arguments[1],s=arguments[2];break;default:t=arguments[0],e=arguments[1],i=arguments[2],s=arguments[3]}var a=new Image;a.addEventListener("load",function(){i(t,a)}),a.addEventListener("error",function(){s(e)}),a.src=e},i.loadResource=r.loadResource=function(t,r,a){var o=this;a=a||{},Array.isArray(t)||(t=[t]);for(var h=!1,u=function(t){h=!0,(a.errorCallback||function(t){throw"Loading Error: "+t}).call(o,t)},c=a.processCallback||n.noop,l=t.length,m=l,f=function(t,e){h||(i.resources[t]||(i.resources[t]=e),m--,c(l-m,l),0===m&&r&&r.call(o,i.resources))},d=a.customResourceTypes||{},p=n.extend({},s,d),g=0;l>g;g++){var v,y,w=t[g];if("object"===n.getType(w)?(v=w.id,y=w.src):v=y=w,i.resources.hasOwnProperty(v))f(v,i.resources[v]);else{var x=o["load"+p[e(y)]];x||(x=o.loadOther),x(v,y,f,u)}}},r}),i("ig/Animation",["require","./util","./Event","./easing"],function(t){function e(t){return i.extend(!0,this,{name:a++,source:{},target:null,range:null,tween:s.linear,repeat:!1,duration:1e3,fps:r},t),this.setup(),this}var i=t("./util"),n=t("./Event"),s=t("./easing"),r=60,a=0;return e.prototype={constructor:e,setup:function(){this.paused=!1,this.repeatCount=0,this.then=Date.now(),this.interval=1e3/this.fps,this.curFrame=0,this.curState={},this.initState={},this.frames=Math.ceil(this.duration*this.fps/1e3);var t=this.source,e=this.target,n=this.range;if(n){for(var s in n)n.hasOwnProperty(s)&&(this.curState[s]={from:parseFloat(parseFloat(t[s])-parseFloat(n[s])),cur:parseFloat(t[s]),to:parseFloat(parseFloat(t[s])+parseFloat(n[s]))});return this}if("array"!==i.getType(e)){for(var r in e)e.hasOwnProperty(r)&&(this.initState[r]=this.curState[r]={from:parseFloat(t[r]),cur:parseFloat(t[r]),to:parseFloat(e[r])});return this}this.animIndex=0,this.animLength=e.length;for(var a=0;a<this.animLength;a++)for(var o in e[a])e[a].hasOwnProperty(o)&&(0===a&&(this.curState[o]={from:parseFloat(t[o]),cur:parseFloat(t[o]),to:parseFloat(e[a][o])}),this.initState[o]={from:parseFloat(t[o]),cur:parseFloat(t[o]),to:parseFloat(e[a][o])});return this},play:function(){return this.requestID&&this.stop(),this.paused=!1,this.step(),this},stop:function(){return window.cancelAnimationFrame(this.requestID),this},destroy:function(){this.stop(),this.clearEvents()},togglePause:function(){return this.paused=!this.paused,this},pause:function(){return this.paused=!0,this},resume:function(){return this.paused=!1,this},next:function(){return this.stop(),this.curFrame++,this.curFrame=this.curFrame>this.frames?this.frames:this.curFrame,this.step.call(this),this},prev:function(){return this.stop(),this.curFrame--,this.curFrame=this.curFrame<0?0:this.curFrame,this.step.call(this),this},gotoAndPlay:function(t){return this.stop(),this.curFrame=t,this.play.call(this),this},gotoAndStop:function(t){return this.stop(),this.curFrame=t,this.step.call(this),this},swapFromTo:function(){if(this.curFrame=0,this.curState={},"array"===i.getType(this.target)){this.target.reverse(),this.animIndex=0,this.animLength=this.target.length;for(var t in this.target[this.animIndex])this.curState[t]=this.repeatCount%2===0?{from:this.initState[t].from,cur:this.initState[t].cur,to:this.initState[t].to}:{from:this.initState[t].to,cur:this.initState[t].to,to:this.initState[t].from}}else for(var e in this.target)this.curState[e]=this.repeatCount%2===0?{from:this.initState[e].from,cur:this.initState[e].cur,to:this.initState[e].to}:{from:this.initState[e].to,cur:this.initState[e].to,to:this.initState[e].from};return this},step:function(){var t=this;if(t.requestID=window.requestAnimationFrame(function(){return function(){t.step.call(t)}}(t)),!(t.paused||(t.now=Date.now(),t.delta=t.now-t.then,t.delta<=t.interval))){t.fire("step",{data:{source:t.source,instance:t}}),t.then=t.now-t.delta%t.interval;var e;for(var i in t.curState)t.curState.hasOwnProperty(i)&&(e=t.tween(t.curFrame,t.curState[i].cur,t.curState[i].to-t.curState[i].cur,t.frames).toFixed(2),t.source[i]=parseFloat(e));if(t.curFrame++,!(t.curFrame<t.frames))if(t.range&&!t.rangeExec){t.curFrame=0;for(var n in t.curState)t.curState.hasOwnProperty(n)&&(t.curState[n]={from:t.curState[n].to,cur:t.curState[n].to,to:t.curState[n].from});t.repeat?(t.repeatCount++,t.repeatCount%2===0&&t.fire("repeat",{data:{source:t.source,instance:t,repeatCount:t.repeatCount/2}})):t.rangeExec=!0}else if(t.animLength)if(t.fire("groupComplete",{data:{source:t.source,instance:t}}),t.animIndex<t.animLength-1){t.animIndex++,t.curFrame=0,t.curState={};var s=t.repeatCount%2===0;for(var r in t.target[t.animIndex])t.target[t.animIndex].hasOwnProperty(r)&&(t.curState[r]={from:s?t.initState[r].from:t.initState[r].to,cur:s?t.initState[r].cur:t.initState[r].to,to:s?t.initState[r].to:t.initState[r].from})}else t.repeat?(t.repeatCount++,t.swapFromTo(),t.fire("repeat",{data:{source:t.source,instance:t,repeatCount:t.repeatCount}})):(t.stop(),t.paused=!1,t.fire("complete",{data:{source:t.source,instance:t}}));else t.repeat?(t.repeatCount++,t.swapFromTo(),t.fire("repeat",{data:{source:t.source,instance:t,repeatCount:t.repeatCount}})):(t.stop(),t.paused=!1,t.fire("complete",{data:{source:t.source,instance:t}}))}}},i.inherits(e,n),e}),i("ig/Game",["require","./Event","./util","./env","./Stage","./resourceLoader"],function(t){function e(t){if(a.extend(!0,this,{name:"ig_game_"+l++,fps:c,canvas:null,maximize:!1,scaleFit:!0,width:m,height:d,maxWidth:f,maxHeight:p,horizontalPageScroll:null},t),!this.canvas)throw new Error("Game initialize must be require a canvas param");return this.paused=!1,this.stageStack=[],this.stages={},i.call(this),this._={},this.resources=u.resources,this}function i(){this.canvas=a.domWrap(this.canvas,document.createElement("div"),"ig-game-container-"+this.name),this.canvas.width=this.width,this.canvas.height=this.height;var t=parseInt(this.canvas.width,10),e=parseInt(this.canvas.height,10),i=this.maxWidth||5e3,r=this.maxHeight||5e3;if(this.maximize){document.body.style.padding=0,document.body.style.margin=0;var h,u=a.getType(this.horizontalPageScroll);h="number"===u?this.horizontalPageScroll:"boolean"===u?17:0,t=Math.min(window.innerWidth,i)-h,e=Math.min(window.innerHeight-5,r)}o.supportTouch&&(this.canvas.style.height=2*e+"px",window.scrollTo(0,1),t=Math.min(window.innerWidth,i),e=Math.min(window.innerHeight,r)),this.ctx=this.canvas.getContext("2d"),this.canvas.style.height=e+"px",this.canvas.style.width=t+"px",this.canvas.width=t,this.canvas.height=e,this.canvas.style.position="relative",this.width=this.canvas.width,this.cssWidth=this.canvas.style.width,this.height=this.canvas.height,this.cssHeight=this.canvas.style.height,n.call(this);var c=this.canvas.parentNode;c.style.width=t+"px",c.style.margin="0 auto",c.style.position="relative",this.scaleFit&&s.call(this);var l=this;return window.addEventListener(o.supportOrientation?"orientationchange":"resize",function(){setTimeout(function(){window.scrollTo(0,1),l.scaleFit&&s.call(l)},0)},!1),this.ratioX=this.width/m,this.ratioY=this.height/d,this}function n(){this.offCanvas||(this.offCanvas=document.createElement("canvas"),this.offCtx=this.offCanvas.getContext("2d")),this.offCanvas.width=this.canvas.width,this.offCanvas.style.width=this.canvas.style.width,this.offCanvas.height=this.canvas.height,this.offCanvas.style.height=this.canvas.style.height}function s(){var t=window.innerWidth,e=window.innerHeight,i=t/e,s=this.canvas.width/this.canvas.height,r=i>s?e/this.canvas.height:t/this.canvas.width,a=this.canvas.width*r,o=this.canvas.height*r;if(this.canvas.style.width=a+"px",this.canvas.style.height=o+"px",this.canvas.parentNode&&(this.canvas.parentNode.style.width=a+"px",this.canvas.parentNode.style.height=o+"px"),s>=i){var h=(e-o)/2;this.canvas.style.top=h+"px"}this.width=this.canvas.width,this.cssWidth=this.canvas.style.width,this.height=this.canvas.height,this.cssHeight=this.canvas.style.height,this.scaleRatio=r,n.call(this)}var r=t("./Event"),a=t("./util"),o=t("./env"),h=t("./Stage"),u=t("./resourceLoader"),c=60,l=0,m=320,f=5e3,d=480,p=5e3;return e.prototype={constructor:e,start:function(){var t=this._;this.paused=!1,t.startTime=Date.now(),t.now=0,t.interval=1e3/this.fps,t.delta=0,t.realFpsStart=Date.now(),t.realFps=0,t.realDelta=0,t.totalFrameCounter=0;var e="",i=a.noop,n=arguments.length;switch(n){case 1:"function"===a.getType(arguments[0])?i=arguments[0]:(e=arguments[0],i=a.noop);break;case 2:e=arguments[0],i=arguments[1]}if(e){for(var s=this.stageStack,r=-1,o=0,h=s.length;h>o;o++)if(s[o].name===e){r=o;break}this.swapStage(r,0)}this.stop();var u=this;return u.render.call(u,e),"function"===a.getType(i)&&i.call(u,{data:{startTime:t.startTime,interval:t.interval}}),this},render:function(){var t=this,e=t._;if(e.requestID=window.requestAnimationFrame(function(t){return function(){t.render.call(t)}}(t)),!this.paused){if(e.now=Date.now(),e.delta=e.now-e.startTime,e.delta>e.interval){e.totalFrameCounter++,e.startTime=e.now-e.delta%e.interval,t.fire("beforeGameRender",{data:{startTime:e.startTime,totalFrameCounter:e.totalFrameCounter}});var i=t.getCurrentStage();i&&(i.update(e.totalFrameCounter,e.delta/1e3),i.render()),t.fire("afterGameRender",{data:{startTime:e.startTime,totalFrameCounter:e.totalFrameCounter}})}e.realDelta>1e3?(e.realFpsStart=Date.now(),e.realDelta=0,t.fire("gameFPS",{data:{fps:e.realFps,totalFrameCounter:e.totalFrameCounter}}),e.realFps=0):(e.realDelta=Date.now()-e.realFpsStart,++e.realFps)}},pause:function(){return this.paused=!0,this},resume:function(){return this.paused=!1,this},stop:function(){return window.cancelAnimationFrame(this._.requestID),this},destroy:function(){this.stop(),this.clearAllStage(),this.clearEvents()},createStage:function(t){t=a.extend(!0,{},{canvas:this.canvas,offCanvas:this.offCanvas,gameOwner:this},t);var e=new h(t);return this.pushStage(e),e},pushStage:function(t){this.getStageByName(t.name)||(t.gameOwner=this,this.stageStack.push(t),this.stages[t.name]=t,this.sortStageIndex())},popStage:function(){var t=this.stageStack.pop();t&&(delete this.stages[t.name],this.sortStageIndex())},sortStageIndex:function(){for(var t=this.stageStack,e=t.length-1,i=0;e>=0;e--,i++)t[e].zIndex=i},removeStageByName:function(t){var e=this.getStageByName(t);if(e){delete this.stages[e.name];var i=this.stageStack;a.removeArrByCondition(i,function(e){return e.name===t}),this.sortStageIndex()}},getCurrentStage:function(){return this.stageStack[0]},getStageStack:function(){return this.stageStack},getStageByName:function(t){return this.stages[t]},changeStage:function(t){if(t){for(var e=this.stageStack,i=-1,n=0,s=e.length;s>n;n++)if(e[n].name===t){i=n;break}this.swapStage(i,0)}},swapStageByName:function(t,e){for(var i=this.stageStack,n=i.length,s=-1,r=-1,a=0;n>a;a++)i[a].name===t&&(s=a),i[a].name===e&&(r=a);return-1!==s&&-1!==r?this.swapStage(s,r):this},swapStage:function(t,e){var i=this.stageStack,n=i.length;if(t>=0&&n-1>=t&&e>=0&&n-1>=e){var s=i[t];i[t]=i[e],i[e]=s,this.sortStageIndex()}return this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this},getStageIndex:function(t){return t.zIndex},clearAllStage:function(){for(var t=this.stageStack,e=0,i=t.length;i>e;e++)t[e].destroy();this.stages={},this.stageStack=[]},loadOther:function(t,e,i,n){u.loadOther(t,e,i,n)},loadImage:function(t,e,i,n){u.loadImage(t,e,i,n)},loadResource:function(t,e,i){u.loadResource(t,e,i)}},a.inherits(e,r),e}),i("ig/Stage",["require","./Event","./util","./DisplayObject","./domEvt","./ig"],function(t){function e(t){return u.extend(!0,this,{name:"ig_stage_"+p++,canvas:t.canvas,ctx:t.canvas.getContext("2d"),offCanvas:t.offCanvas,offCtx:t.offCanvas.getContext("2d"),width:t.gameOwner.width,height:t.gameOwner.height,cssWidth:t.gameOwner.cssWidth,cssHeight:t.gameOwner.cssHeight,captureFunc:u.noop,moveFunc:u.noop,releaseFunc:u.noop},t),this.displayObjectList=[],this.displayObjects={},i.call(this),this}function i(){return n.call(this),l.initMouse(this),this}function n(){var t=this;return l.events.forEach(function(e){var i=l.fireEvt[e];i&&t.on(e,i)}),t}function s(t){var e=this.parallax;e&&(e.anims&&"array"===u.getType(e.anims)?(e.animInterval=e.animInterval||1e4,e.curAnim||(e.curAnim=e.anims[0]),t%e.animInterval===0&&(void 0===e.time&&(e.time=0),e.time++,e.time===e.anims.length&&(e.time=0),e.curAnim=e.anims[e.time])):e.curAnim={aX:e.aX,aY:e.aY},e.vX=(e.vX+e.curAnim.aX)%e.image.width,e.vY=(e.vY+e.curAnim.aY)%e.image.height)}function r(){var t=this.parallax;if(t){var e=this.offCtx;"no-repeat"!==t.repeat&&a.call(t,e);for(var i=t.image.width,n=t.image.height,s={width:0,height:0},r=0;n>r;r+=s.height)for(var h=0;i>h;h+=s.width){var u={x:t.x+h,y:t.y+r},c={width:i-h,height:n-r},l={x:0,y:0};0===h&&(l.x=t.vX),0===r&&(l.y=t.vY),s=o.call(t,e,u,c,l,i,n)}}}function a(t){t.save(),t.fillStyle=t.createPattern(this.image,this.repeat),t.fillRect(this.x,this.y,t.canvas.width,t.canvas.height),t.restore(),d.src||(d.src=t.canvas.toDataURL(),this.image=d)}function o(t,e,i,n,s,r){var a=Math.abs(n.x)%s,o=Math.abs(n.y)%r,h=n.x<0?s-a:a,u=n.y<0?r-o:o,c=i.width<s-h?i.width:s-h,l=i.height<r-u?i.height:r-u;return t.drawImage(this.image,h,u,c,l,e.x,e.y,c,l),{width:c,height:l}}var h=t("./Event"),u=t("./util"),c=t("./DisplayObject"),l=t("./domEvt"),m=t("./ig"),f=m.STATUS,d=new Image,p=0;return e.prototype={constructor:e,setCaptureFunc:function(t){return this.captureFunc=t||u.noop,this},setMoveFunc:function(t){return this.moveFunc=t||u.noop,this},setReleaseFunc:function(t){return this.releaseFunc=t||u.noop,this},clear:function(){return this.offCtx.clearRect(0,0,this.width,this.height),this},getIndex:function(){return this.zIndex},setBgColor:function(t){return this.bgColor=t,this.canvas.style.backgroundColor=this.bgColor||"transparent",this},setBgImg:function(t,e){var i;"htmlimageelement"===u.getType(t)?i=t.src:"string"===u.getType(t)&&(i=t);var n="",s="",r="";switch(e){case"center":n="no-repeat",s="center";break;case"full":r=this.cssWidth+"px "+this.cssHeight+"px"}return i?(this.canvas.style.backgroundImage="url("+i+")",this.canvas.style.backgroundRepeat=n,this.canvas.style.backgroundPosition=s,this.canvas.style.backgroundSize=r):(this.canvas.style.backgroundImage="",this.canvas.style.backgroundRepeat="",this.canvas.style.backgroundPosition="",this.canvas.style.backgroundSize=""),this},setParallax:function(t){if(t=t||{},!t.image)throw new Error("Parallax must be require a image param");return t.repeat=t.repeat&&-1!==["repeat","repeat-x","repeat-y"].indexOf(t.repeat)?t.repeat:"no-repeat",this.parallax=u.extend({},{x:0,y:0,vX:0,vY:0,aX:0,aY:0},t),this},update:function(t,e){0>e&&(e=1/60),e>1/15&&(e=1/15),s.call(this,t);for(var i,n=this.displayObjectList,r=n.length,a=0;r>a;a++){var o=n[a];o&&(i=o.status,(i===f.NORMAL||i===f.NOT_RENDER)&&(o._update(e),o.update(e)))}},render:function(){this.clear(),this.fire("beforeStageRender"),this.offCtx.save(),this.offCtx.clearRect(0,0,this.offCanvas.width,this.offCanvas.height),r.call(this),this.sortDisplayObject();for(var t,e=this.displayObjectList,i=e.length,n=0;i>n;n++){var s=e[n];s&&(t=s.status,t===f.DESTROYED?this.removeDisplayObject(s):(t===f.NORMAL||t===f.NOT_UPDATE)&&s.render(this.offCtx))}this.offCtx.restore(),this.ctx.drawImage(this.offCanvas,0,0),this.fire("afterStageRender")},sortDisplayObject:function(){this.displayObjectList.sort(function(t,e){return t.zIndex-e.zIndex})},getDisplayObjectList:function(){return this.displayObjectList},getDisplayObjectByName:function(t){return this.displayObjects[t]},createDisplayObject:function(t){var e=new c(t);return this.addDisplayObject(e),e},addDisplayObject:function(t){return t&&!this.getDisplayObjectByName(t.name)&&(t.stageOwner=t.stageOwner=this,this.displayObjectList.push(t),this.displayObjects[t.name]=t),this},removeDisplayObject:function(t){return t&&this.removeDisplayObjectByName(t.name),this},removeDisplayObjectByName:function(t){var e=this.displayObjects[t];if(e){delete this.displayObjects[e.name];var i=this.displayObjectList;u.removeArrByCondition(i,function(e){return e.name===t})}return this},clearAllDisplayObject:function(){this.displayObjectList=[],this.displayObjects={}},destroy:function(){this.clearAllDisplayObject(),this.clearEvents()}},u.inherits(e,h),e}),i("ig/DisplayObject",["require","./Event","./util","./Animation","./ig","./Matrix"],function(t){function e(t){return n.extend(!0,this,{name:"ig_displayobject_"+h++,x:0,y:0,width:0,height:0,cX:0,cY:0,radius:0,scaleX:1,scaleY:1,angle:0,alpha:1,zIndex:0,fillStyle:"transparent",strokeStyle:"transparent",image:null,vX:0,vY:0,aX:0,aY:0,frictionX:1,frictionY:1,status:o.NORMAL,mouseEnable:!0,captureFunc:n.noop,moveFunc:n.noop,releaseFunc:n.noop,debug:!1},t),this.children=[],this.matrix=new a,this.setPosX(this.x),this.setPosY(this.y),this}var i=t("./Event"),n=t("./util"),s=t("./Animation"),r=t("./ig"),a=t("./Matrix"),o=r.STATUS,h=0;return e.prototype={constructor:e,changeStatus:function(t){return this.status=t||this.status,this},setCaptureFunc:function(t){return this.captureFunc=t||n.noop,this},setMoveFunc:function(t){return this.moveFunc=t||n.noop,this},setReleaseFunc:function(t){return this.releaseFunc=t||n.noop,this},setPosX:function(t){return this.x=t||0,this},setPosY:function(t){return this.y=t||0,this},setAccelerationX:function(t){return this.aX=t||this.aX,this},setAccelerationY:function(t){return this.aY=t||this.aY,this},setFrictionX:function(t){return this.frictionX=t||this.frictionX,this},setFrictionY:function(t){return this.frictionY=t||this.frictionY,this},move:function(t,e){return this.x+=t,this.y+=e,this},moveStep:function(){return this.vX+=this.aX,this.vX*=this.frictionX,this.x+=this.vX,this.vY+=this.aY,this.vY*=this.frictionY,this.y+=this.vY,this},rotate:function(t){var e=this.stageOwner.offCtx;return e.save(),e.rotate(n.deg2Rad(t||this.angle)),e.restore(),this},setAnimate:function(t){var e=this,i=n.extend(!0,{},{fps:60,duration:1e3,source:e,target:{}},t),r="function"===n.getType(i.stepFunc)?i.stepFunc:n.noop,a="function"===n.getType(i.repeatFunc)?i.repeatFunc:n.noop,o="function"===n.getType(i.groupCompleteFunc)?i.groupCompleteFunc:n.noop,h="function"===n.getType(i.completeFunc)?i.completeFunc:n.noop;return this.animate=new s(i).play().on("step",function(t){r(t)}).on("repeat",function(t){a(t)}).on("groupComplete",function(t){o(t)}).on("complete",function(t){h(t)}),this},stopAnimate:function(){return this.animate&&this.animate.stop(),this},destroyAnimate:function(){return this.animate&&this.animate.destroy(),this},_update:function(){return this},update:function(){return this},render:function(){return this},hitTestPoint:function(){return!1},destroy:function(){this.status=o.DESTROYED}},n.inherits(e,i),e}),i("ig/Text",["require","./util","./DisplayObject"],function(t){function e(t){s.call(this,t),n.extend(!0,this,{content:"",size:30,isBold:!1,fontFamily:"sans-serif"},t);var e=i(this.content,this.isBold,this.fontFamily,this.size);return this.bounds={x:this.x,y:this.y,width:e.width,height:e.height},this.font=""+(this.isBold?"bold ":"")+this.size+"pt "+this.fontFamily,this}function i(t,e,i,n){var s=document.createElement("div");s.innerHTML=t,s.style.position="absolute",s.style.top="-1000px",s.style.left="-1000px",s.style.fontFamily=i,s.style.fontWeight=e?"bold":"normal",s.style.fontSize=n+"pt",document.body.appendChild(s);var r={width:s.offsetWidth,height:s.offsetHeight};return document.body.removeChild(s),r}var n=t("./util"),s=t("./DisplayObject");return e.prototype={constructor:e,changeContent:function(t){this.content=t;var e=i(this.content,this.isBold,this.fontFamily,this.size);return this.bounds={x:this.x,y:this.y,width:e.width,height:e.height},this},getContent:function(){return this.content},render:function(t){t.save(),t.fillStyle=this.fillStyle,t.globalAlpha=this.alpha,t.font=this.font,this.matrix.reset(),this.matrix.translate(this.x,this.y),this.matrix.rotate(this.angle),this.matrix.scale(this.scaleX,this.scaleY);var e=this.matrix.m;return t.transform(e[0],e[1],e[2],e[3],e[4],e[5]),t.fillText(this.content,.5*-this.bounds.width,.5*-this.bounds.height),this.debugRender(t),t.restore(),this},debugRender:function(t){if(this.debug){t.save();
var e=this.matrix.reset().m;this.matrix.translate(-this.bounds.x-.5*this.bounds.width,-this.bounds.y-this.bounds.height-10),t.transform(e[0],e[1],e[2],e[3],e[4],e[5]),t.strokeStyle="black",t.strokeRect(this.bounds.x,this.bounds.y,this.bounds.width,this.bounds.height),t.restore()}}},n.inherits(e,s),e}),i("ig/Bitmap",["require","./util","./Rectangle"],function(t){function e(t){if(t=t||{},!t.image)throw new Error("Bitmap must be require a image param");return n.call(this,t),i.extend(!0,this,{width:this.image.width,height:this.image.height,sX:0,sY:0,sWidth:0,sHeight:0},t),this}var i=t("./util"),n=t("./Rectangle");return e.prototype={constructor:e,render:function(t){t.save(),t.globalAlpha=this.alpha,e.superClass.render.apply(this,arguments);var i=this.matrix.m;return t.transform(i[0],i[1],i[2],i[3],i[4],i[5]),t.drawImage(this.image,this.sX,this.sY,this.sWidth,this.sHeight,this.x,this.y,this.width,this.height),t.restore(),this}},i.inherits(e,n),e}),i("ig/BitmapPolygon",["require","./util","./Polygon"],function(t){function e(t){if(t=t||{},!t.image)throw new Error("BitmapPolygon must be require a image param");return n.call(this,t),i.extend(!0,this,{sX:0,sY:0,sWidth:0,sHeight:0},t),this}var i=t("./util"),n=t("./Polygon");return e.prototype={constructor:e,render:function(t){t.save(),t.globalAlpha=this.alpha,e.superClass.render.apply(this,arguments);var i=this.matrix.m;return t.transform(i[0],i[1],i[2],i[3],i[4],i[5]),t.drawImage(this.image,this.sX,this.sY,this.sWidth,this.sHeight,this.x,this.y,this.bounds.width,this.bounds.height),t.restore(),this}},i.inherits(e,n),e}),i("ig/SpriteSheet",["require","./util","./Rectangle"],function(t){function e(t){if(t=t||{},!t.image)throw new Error("SpriteSheet must be require a image param");return n.apply(this,arguments),i.extend(this,{total:1,sX:0,sY:0,cols:0,rows:0,tileW:0,tileH:0,offsetX:0,offsetY:0,ticksPerFrame:0,isOnce:!1,onceDone:i.noop},t),this.tickUpdateCount=0,this.frameIndex=0,this.originalSX=this.sX,this.originalTotal=this.total,this.realCols=s(this.cols-this.sX/this.tileW),this.width=this.tileW,this.height=this.tileH,this}var i=t("./util"),n=t("./Rectangle"),s=Math.floor;return e.prototype={constructor:e,changeFrame:function(t){return i.extend(this,{total:this.total,x:this.x,y:this.y,sX:this.sX,sY:this.sY,cols:this.cols,rows:this.rows,tileW:0,tileH:0,offsetX:0,offsetY:0,ticksPerFrame:this.ticksPerFrame,isOnce:!1,onceDone:i.noop},t),this.tickUpdateCount=0,this.frameIndex=0,this.originalSX=this.sX,this.originalTotal=this.total,this.realCols=s(this.cols-this.sX/this.tileW),this.width=this.tileW,this.height=this.tileH,this},_update:function(){if(this.tickUpdateCount++,this.tickUpdateCount>this.ticksPerFrame){if(this.tickUpdateCount=0,this.frameIndex<this.total-1)this.frameIndex++;else if(this.frameIndex=0,this.total=this.originalTotal,this.sX=this.originalSX,this.realCols=s(this.cols-this.originalSX/this.tileW),this.sY-=(this.rows-1)*this.tileH,this.isOnce&&(this.status=5,"function"===i.getType(this.onceDone))){var t=this;setTimeout(function(){t.onceDone(t)},100)}this.frameIndex===this.realCols&&(this.total-=this.realCols,this.frameIndex=0,this.sY+=this.tileH,this.sX=0,this.realCols=this.cols)}return this},render:function(t){t.save(),t.globalAlpha=this.alpha,e.superClass.render.apply(this,arguments);var i=this.matrix.m;return t.transform(i[0],i[1],i[2],i[3],i[4],i[5]),t.drawImage(this.image,this.frameIndex*this.tileW+this.sX,this.sY,this.tileW,this.tileH,this.x+this.offsetX,this.y+this.offsetY,this.tileW,this.tileH),t.restore(),this}},i.inherits(e,n),e}),i("ig/Event",["require"],function(){function t(){this._events={}}var e="_observerGUID";return t.prototype={constructor:t,on:function(t,i){this._events||(this._events={});var n=this._events[t];return n||(n=this._events[t]=[]),i.hasOwnProperty(e)||(i[e]=+new Date),n.push(i),this},un:function(t,e){if(this._events){if(!e)return void(this._events[t]=[]);var i=this._events[t];if(i)for(var n=0;n<i.length;n++)i[n]===e&&(i.splice(n,1),n--);return this}},fire:function(t,i){1===arguments.length&&"object"==typeof t&&(i=t,t=i.type);var n=this["on"+t];if("function"==typeof n&&n.call(this,i),this._events){null==i&&(i={}),"[object Object]"!==Object.prototype.toString.call(i)&&(i={data:i}),i.type=t,i.target=this;var s={},r=this._events[t];if(r){r=r.slice();for(var a=0;a<r.length;a++){var o=r[a];s.hasOwnProperty(o[e])||o.call(this,i)}}if("*"!==t){var h=this._events["*"];if(!h)return;h=h.slice();for(var a=0;a<h.length;a++){var o=h[a];s.hasOwnProperty(o[e])||o.call(this,i)}}}},clearEvents:function(){this._events={}},enable:function(e){e._events={},e.on=t.prototype.on,e.un=t.prototype.un,e.fire=t.prototype.fire}},t}),i("ig/domEvt",["require","./util","./env"],function(t){function e(t){for(var e=0,i=a.length;i>e;e++)if(a[e].name===t)return!0;return!1}var i=t("./util"),n=t("./env"),s=["touchstart","touchmove","touchend"],r=["mousedown","mousemove","mouseup"],a=[],o=0,h=0,u={};return u.events=n.supportTouch?s:r,u.fireEvt={},u.fireEvt.touchstart=u.fireEvt.mousedown=function(t){var e=t.target;"function"===i.getType(e.captureFunc)&&e.captureFunc.call(e,t.data);for(var n,s=e.displayObjectList,r=-1,a=0,u=s.length;u>a;a++){var c=s[a];c.mouseEnable&&c.hitTestPoint(t.data.x,t.data.y)&&c.zIndex>=r&&(r=c.zIndex,n=c)}return n&&(t.data.curStage=e,n.isCapture=!0,o=t.data.x-n.x,h=t.data.y-n.y,n.captureFunc.call(n,t.data)),e},u.fireEvt.touchmove=u.fireEvt.mousemove=function(t){var n=t.target;"function"===i.getType(n.moveFunc)&&n.moveFunc.call(n,t.data);for(var s=n.displayObjectList,r=0,u=s.length;u>r;r++){var c=s[r];c.hitTestPoint(t.data.x,t.data.y)&&!e(c.name)&&a.push(c),t.data.holdSprites=a,c.mouseEnable&&c.isCapture&&(t.data.curStage=n,t.data.x=t.data.x-o,t.data.y=t.data.y-h,c.moveFunc.call(c,t.data))}return n},u.fireEvt.touchend=u.fireEvt.mouseup=function(t){var n=t.target;"function"===i.getType(n.releaseFunc)&&n.releaseFunc.call(n,t.data);for(var s=n.displayObjectList,r=0,u=s.length;u>r;r++){var c=s[r];(c.isCapture||e(c.name))&&(c.releaseFunc.call(c,t.data),c.isCapture=!1)}return o=0,h=0,a=[],n},u.initMouse=function(t){this.stage=t,this.element=t.canvas,this.x=0,this.y=0,this.isDown=!1;var e=i.getElementOffset(this.element);return this.offsetX=e.x,this.offsetY=e.y,this.addEvent(),this},u.addEvent=function(){var t=this,e=t.element;t.events.forEach(function(i,n){e.addEventListener(i,function(e){0===n?t.isDown=!0:2===n&&(t.isDown=!1);var s=e.changedTouches?e.changedTouches[0].pageX:e.pageX,r=e.changedTouches?e.changedTouches[0].pageY:e.pageY;t.x=s-t.offsetX,t.y=r-t.offsetY,t.stage.fire(i,{data:{x:t.x,y:t.y,isDown:t.isDown,domEvent:e}})})})},u}),i("ig/Matrix",["require","./util"],function(t){function e(){return this.m=[1,0,0,1,0,0],this}var i=t("./util"),n=Math.cos,s=Math.sin;return e.prototype={constructor:e,reset:function(){return this.m=[1,0,0,1,0,0],this},mul:function(t){var e=this.m[0]*t.m[0]+this.m[2]*t.m[1],i=this.m[1]*t.m[0]+this.m[3]*t.m[1],n=this.m[0]*t.m[2]+this.m[2]*t.m[3],s=this.m[1]*t.m[2]+this.m[3]*t.m[3],r=this.m[0]*t.m[4]+this.m[2]*t.m[5]+this.m[4],a=this.m[1]*t.m[4]+this.m[3]*t.m[5]+this.m[5];return this.m[0]=e,this.m[1]=i,this.m[2]=n,this.m[3]=s,this.m[4]=r,this.m[5]=a,this},invert:function(){var t=1/(this.m[0]*this.m[3]-this.m[1]*this.m[2]),e=this.m[3]*t,i=-this.m[1]*t,n=-this.m[2]*t,s=this.m[0]*t,r=t*(this.m[2]*this.m[5]-this.m[3]*this.m[4]),a=t*(this.m[1]*this.m[4]-this.m[0]*this.m[5]);return this.m[0]=e,this.m[1]=i,this.m[2]=n,this.m[3]=s,this.m[4]=r,this.m[5]=a,this},rotate:function(t){var e=i.deg2Rad(t),r=n(e),a=s(e),o=this.m[0]*r+this.m[2]*a,h=this.m[1]*r+this.m[3]*a,u=this.m[0]*-a+this.m[2]*r,c=this.m[1]*-a+this.m[3]*r;return this.m[0]=o,this.m[1]=h,this.m[2]=u,this.m[3]=c,this},translate:function(t,e){return this.m[4]+=this.m[0]*t+this.m[2]*e,this.m[5]+=this.m[1]*t+this.m[3]*e,this},scale:function(t,e){return this.m[0]*=t,this.m[1]*=t,this.m[2]*=e,this.m[3]*=e,this},transformPoint:function(t,e){var i=t,n=e;return t=i*this.m[0]+n*this.m[2]+this.m[4],e=i*this.m[1]+n*this.m[3]+this.m[5],{x:t,y:e}}},e}),i("ig/Vector",["require"],function(){function t(t,e){this.x=t||0,this.y=e||t||0}var e=Math.sqrt,i=Math.pow;return t.prototype={constructor:t,normalize:function(){var t=this.getMagnitude();return 0!==t&&(this.x/=t,this.y/=t),this},getMagnitude:function(){return e(i(this.x,2)+i(this.y,2))},add:function(e,i){var n=this.x+e.x,s=this.y+e.y;return i?new t(n,s):(this.x=n,this.y=s,this)},sub:function(e,i){var n=this.x-e.x,s=this.y-e.y;return i?new t(n,s):(this.x=n,this.y=s,this)},dot:function(t){return this.x*t.x+this.y*t.y},edge:function(t){return this.sub(t,!0)},perpendicular:function(e){var i=-this.x,n=this.y;return e?new t(i,n):(this.x=i,this.y=n,this)},normal:function(){return this.perpendicular(!0).normalize()}},t}),i("ig/Polygon",["require","./util","./Vector","./Projection","./DisplayObject"],function(t){function e(t){r.call(this,t),i.extend(!0,this,{points:[]},t);for(var e=0,n=this.points.length;n>e;e++){var s=this.points[e];this.points[e]={x:s.x+this.x,y:s.y+this.y}}return this.origin={x:this.x,y:this.y,points:i.extend(!0,[],this.points),persistencePoints:i.extend(!0,[],this.points)},this.getBounds(),this.cX=this.bounds.x+this.bounds.width/2,this.cY=this.bounds.y+this.bounds.height/2,this}var i=t("./util"),n=t("./Vector"),s=t("./Projection"),r=t("./DisplayObject");return e.prototype={constructor:e,generatePoints:function(){for(var t=0,e=this.origin.points.length;e>t;t++){var i=this.matrix.transformPoint(this.origin.points[t].x,this.origin.points[t].y);this.points[t]={x:i.x,y:i.y}}return this},createPath:function(t){var e=this.points,i=e.length;if(i){t.beginPath(),t.moveTo(e[0].x,e[0].y);for(var n=0;i>n;n++)t.lineTo(e[n].x,e[n].y);return t.closePath(),this}},move:function(t,e){this.x=t,this.y=e;for(var i=0,n=this.origin.persistencePoints.length;n>i;i++)this.origin.points[i]={x:this.origin.persistencePoints[i].x+t-this.origin.x,y:this.origin.persistencePoints[i].y+e-this.origin.y};for(var s=this.origin.points,r=Number.MAX_VALUE,a=Number.MIN_VALUE,o=Number.MAX_VALUE,h=Number.MIN_VALUE,u=0,c=s.length;c>u;u++)s[u].x<r&&(r=s[u].x),s[u].x>a&&(a=s[u].x),s[u].y<o&&(o=s[u].y),s[u].y>h&&(h=s[u].y);return this.cX=r+(a-r)/2,this.cY=o+(h-o)/2,this},moveStep:function(){var t=this.x;this.vX+=this.aX,this.vX*=this.frictionX,this.x+=this.vX;var e=this.y;this.vY+=this.aY,this.vY*=this.frictionY,this.y+=this.vY;for(var i=0,n=this.origin.points.length;n>i;i++)this.origin.points[i]={x:this.origin.points[i].x+this.x-t,y:this.origin.points[i].y+this.y-e};for(var s=this.origin.points,r=Number.MAX_VALUE,a=Number.MIN_VALUE,o=Number.MAX_VALUE,h=Number.MIN_VALUE,u=0,c=s.length;c>u;u++)s[u].x<r&&(r=s[u].x),s[u].x>a&&(a=s[u].x),s[u].y<o&&(o=s[u].y),s[u].y>h&&(h=s[u].y);return this.cX=r+(a-r)/2,this.cY=o+(h-o)/2,this},render:function(t){return t.save(),t.fillStyle=this.fillStyle,t.strokeStyle=this.strokeStyle,t.globalAlpha=this.alpha,this.matrix.reset(),this.matrix.translate(this.cX,this.cY),this.matrix.rotate(this.angle),this.matrix.scale(this.scaleX,this.scaleY),this.matrix.translate(-this.cX,-this.cY),this.generatePoints(),this.getBounds(),this.createPath(t),t.fill(),t.stroke(),this.debugRender(t),t.restore(),this},getBounds:function(){for(var t=this.points,e=Number.MAX_VALUE,i=Number.MIN_VALUE,n=Number.MAX_VALUE,s=Number.MIN_VALUE,r=0,a=t.length;a>r;r++)t[r].x<e&&(e=t[r].x),t[r].x>i&&(i=t[r].x),t[r].y<n&&(n=t[r].y),t[r].y>s&&(s=t[r].y);return this.bounds={x:e,y:n,width:i-e,height:s-n},this},isPointInPath:function(t,e,i){return this.createPath(t),t.isPointInPath(e,i)},hitTestPoint:function(t,e){var i=this.stageOwner;return this.isPointInPath(i.offCtx,t,e)},getAxes:function(){for(var t=new n,e=new n,i=[],s=this.points,r=0,a=s.length-1;a>r;r++)t.x=s[r].x,t.y=s[r].y,e.x=s[r+1].x,e.y=s[r+1].y,i.push(t.edge(e).normal());return i},project:function(t){for(var e=[],i=new n,r=this.points,a=0,o=r.length;o>a;a++){var h=r[a];i.x=h.x,i.y=h.y,e.push(i.dot(t))}return new s(Math.min.apply(Math,e),Math.max.apply(Math,e))},collidesWith:function(t){var e=this.getAxes().concat(t.getAxes());return!this.separationOnAxes(e,t)},separationOnAxes:function(t,e){for(var i=0,n=t.length;n>i;i++){var s=t[i],r=e.project(s),a=this.project(s);if(!r.overlaps(a))return!0}return!1},debugRender:function(t){this.debug&&(t.save(),t.strokeStyle="green",t.strokeRect(this.bounds.x,this.bounds.y,this.bounds.width,this.bounds.height),t.restore())}},i.inherits(e,r),e}),i("ig/Rectangle",["require","./util","./Vector","./Projection","./MinTranslationVector","./DisplayObject"],function(t){function e(t){return a.call(this,t),this.generatePoints(),this.getBounds(),this}var i=t("./util"),n=t("./Vector"),s=t("./Projection"),r=t("./MinTranslationVector"),a=t("./DisplayObject");return e.prototype={constructor:e,generatePoints:function(){this.points=[{x:this.x,y:this.y},{x:this.x+this.width,y:this.y},{x:this.x+this.width,y:this.y+this.height},{x:this.x,y:this.y+this.height}];for(var t=0,e=this.points.length;e>t;t++){var i=this.matrix.transformPoint(this.points[t].x,this.points[t].y);this.points[t]={x:i.x,y:i.y}}return this.cX=this.x+this.width/2,this.cY=this.y+this.height/2,this},createPath:function(t){var e=this.points,i=e.length;if(i){t.beginPath(),t.moveTo(e[0].x,e[0].y);for(var n=0;i>n;n++)t.lineTo(e[n].x,e[n].y);return t.closePath(),this}},move:function(t,e){return this.x=t,this.y=e,this.generatePoints(),this.getBounds(),this},moveStep:function(){return this.vX+=this.aX,this.vX*=this.frictionX,this.x+=this.vX,this.vY+=this.aY,this.vY*=this.frictionY,this.y+=this.vY,this.generatePoints(),this.getBounds(),this},render:function(t){return t.save(),t.fillStyle=this.fillStyle,t.strokeStyle=this.strokeStyle,t.globalAlpha=this.alpha,this.matrix.reset(),this.matrix.translate(this.cX,this.cY),this.matrix.rotate(this.angle),this.matrix.scale(this.scaleX,this.scaleY),this.matrix.translate(-this.cX,-this.cY),this.generatePoints(),this.getBounds(),this.createPath(t),t.fill(),t.stroke(),this.debugRender(t),t.restore(),this},getBounds:function(){for(var t=this.points,e=Number.MAX_VALUE,i=Number.MIN_VALUE,n=Number.MAX_VALUE,s=Number.MIN_VALUE,r=0,a=t.length;a>r;r++)t[r].x<e&&(e=t[r].x),t[r].x>i&&(i=t[r].x),t[r].y<n&&(n=t[r].y),t[r].y>s&&(s=t[r].y);return this.bounds={x:e,y:n,width:i-e,height:s-n},this},isPointInPath:function(t,e,i){return this.createPath(t),t.isPointInPath(e,i)},hitTestPoint:function(t,e){var i=this.stageOwner;return this.isPointInPath(i.offCtx,t,e)},getAxes:function(){for(var t=new n,e=new n,i=[],s=this.points,r=0,a=s.length-1;a>r;r++)t.x=s[r].x,t.y=s[r].y,e.x=s[r+1].x,e.y=s[r+1].y,i.push(t.edge(e).normal());return i},project:function(t){for(var e=[],i=new n,r=this.points,a=0,o=r.length;o>a;a++){var h=r[a];i.x=h.x,i.y=h.y,e.push(i.dot(t))}return new s(Math.min.apply(Math,e),Math.max.apply(Math,e))},collidesWith:function(t){return!(this.x+this.width<t.x||t.x+t.width<this.x||this.y+this.height<t.y||t.y+t.height<this.y)},minTranslationVector:function(t,e){for(var i,n,s=Number.MAX_VALUE,a=0;a<t.length;a++){var o=t[a],h=this.project(o),u=e.project(o),i=h.getOverlap(u);if(0===i)return new r(void 0,0);s>i&&(s=i,n=o)}return new r(n,s)},separationOnAxes:function(t,e){for(var i=0,n=t.length;n>i;i++){var s=t[i],r=e.project(s),a=this.project(s);if(!r.overlaps(a))return!0}return!1},debugRender:function(t){this.debug&&(t.save(),t.strokeStyle="green",t.strokeRect(this.bounds.x,this.bounds.y,this.bounds.width,this.bounds.height),t.restore())}},i.inherits(e,a),e}),i("ig/MinTranslationVector",["require"],function(){function t(t,e){this.axis=t,this.overlap=e}return t}),i("ig/Projection",["require"],function(){function t(t,e){this.min=t,this.max=e}return t.prototype={constructor:t,overlaps:function(t){return this.max>t.min&&this.min<t.max},getOverlap:function(t){var e;return this.overlaps(t)?e=this.max>t.max?t.max-this.min:this.max-t.min:0}},t});var n,s=e("ig"),r="ig/util",a="util",o="";o?s[o]?s[o][a]=e(r):(n={},n[a]=e(r),s[o]=n):(n=e(r),a&&(s[a]=n));var n,r="ig/easing",a="easing",o="";o?s[o]?s[o][a]=e(r):(n={},n[a]=e(r),s[o]=n):(n=e(r),a&&(s[a]=n));var n,r="ig/env",a="env",o="";o?s[o]?s[o][a]=e(r):(n={},n[a]=e(r),s[o]=n):(n=e(r),a&&(s[a]=n));var n,r="ig/resourceLoader",a="",o="";o?s[o]?s[o][a]=e(r):(n={},n[a]=e(r),s[o]=n):(n=e(r),a&&(s[a]=n));var n,r="ig/Animation",a="Animation",o="";o?s[o]?s[o][a]=e(r):(n={},n[a]=e(r),s[o]=n):(n=e(r),a&&(s[a]=n));var n,r="ig/Game",a="Game",o="";o?s[o]?s[o][a]=e(r):(n={},n[a]=e(r),s[o]=n):(n=e(r),a&&(s[a]=n));var n,r="ig/Stage",a="Stage",o="";o?s[o]?s[o][a]=e(r):(n={},n[a]=e(r),s[o]=n):(n=e(r),a&&(s[a]=n));var n,r="ig/DisplayObject",a="DisplayObject",o="";o?s[o]?s[o][a]=e(r):(n={},n[a]=e(r),s[o]=n):(n=e(r),a&&(s[a]=n));var n,r="ig/Text",a="Text",o="";o?s[o]?s[o][a]=e(r):(n={},n[a]=e(r),s[o]=n):(n=e(r),a&&(s[a]=n));var n,r="ig/Bitmap",a="Bitmap",o="";o?s[o]?s[o][a]=e(r):(n={},n[a]=e(r),s[o]=n):(n=e(r),a&&(s[a]=n));var n,r="ig/BitmapPolygon",a="BitmapPolygon",o="";o?s[o]?s[o][a]=e(r):(n={},n[a]=e(r),s[o]=n):(n=e(r),a&&(s[a]=n));var n,r="ig/SpriteSheet",a="SpriteSheet",o="";o?s[o]?s[o][a]=e(r):(n={},n[a]=e(r),s[o]=n):(n=e(r),a&&(s[a]=n));var n,r="ig/Event",a="",o="";o?s[o]?s[o][a]=e(r):(n={},n[a]=e(r),s[o]=n):(n=e(r),a&&(s[a]=n));var n,r="ig/domEvt",a="",o="";o?s[o]?s[o][a]=e(r):(n={},n[a]=e(r),s[o]=n):(n=e(r),a&&(s[a]=n));var n,r="ig/Matrix",a="Matrix",o="";o?s[o]?s[o][a]=e(r):(n={},n[a]=e(r),s[o]=n):(n=e(r),a&&(s[a]=n));var n,r="ig/Vector",a="Vector",o="";o?s[o]?s[o][a]=e(r):(n={},n[a]=e(r),s[o]=n):(n=e(r),a&&(s[a]=n));var n,r="ig/Polygon",a="Polygon",o="";o?s[o]?s[o][a]=e(r):(n={},n[a]=e(r),s[o]=n):(n=e(r),a&&(s[a]=n));var n,r="ig/Rectangle",a="Rectangle",o="";o?s[o]?s[o][a]=e(r):(n={},n[a]=e(r),s[o]=n):(n=e(r),a&&(s[a]=n));var n,r="ig/MinTranslationVector",a="",o="";o?s[o]?s[o][a]=e(r):(n={},n[a]=e(r),s[o]=n):(n=e(r),a&&(s[a]=n));var n,r="ig/Projection",a="",o="";o?s[o]?s[o][a]=e(r):(n={},n[a]=e(r),s[o]=n):(n=e(r),a&&(s[a]=n)),t.ig=s}(window);